{
    "rules": [
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id with maxspan=5m\n  [process where event.action == \"start\" and process.code_signature.trusted != true]\n  [any where _arraysearch(event.category, $arg, $arg : (\"registry\", \"file\")) and event.action != \"deletion\" and\n   (\n    (registry.data.strings[0] != null and \n     registry.path : \n            (\"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n             \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n             \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\", \n             \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\",\n             /* Issue #320 */\n             \"HKEY_USERS\\\\*\\\\Environment\\\\UserInitMprLogonScript\",\n             \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\Load\",\n             \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\")) or\n    (file.name != null and file.path : \"?:\\\\*\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\")\n   )\n   ]\n  [any where _arraysearch(event.category, $arg, $arg : (\"registry\", \"file\")) and event.action != \"deletion\" and\n   (\n    (registry.data.strings[0] != null and\n     registry.path :\n            (\"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n             \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n             \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\",\n             \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\",\n             /* Issue #320 */\n             \"HKEY_USERS\\\\*\\\\Environment\\\\UserInitMprLogonScript\",\n             \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\Load\",\n             \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\")) or\n    (file.name != null and file.path : \"?:\\\\*\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\")\n   )\n   ]\n",
            "rule": {
                "description": "Identifies the execution of an untrusted program with two persistence locations (registry run keys and startup folder). Adversaries may use this technique to maintain multiple methods of persistence on an endpoint.",
                "id": "392b0c89-1427-4601-8b32-01e8e40600a6",
                "name": "Untrusted Program with Double Startup Persistence",
                "reference": [
                    "https://docs.microsoft.com/en-us/previous-versions/technet-magazine/ee851671(v=msdn.10)"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1112",
                            "name": "Modify Registry",
                            "reference": "https://attack.mitre.org/techniques/T1112/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  descendant of [process where event.action == \"start\" and\n                 process.name :\n                       (\"WINWORD.EXE\",\n                        \"EXCEL.EXE\",\n                        \"POWERPNT.EXE\",\n                        \"MSACCESS.EXE\",\n                        \"MSPUB.EXE\",\n                        \"fltldr.exe\")] and\n    (\n    (process.pe.original_file_name : \"wmic.exe\" and process.command_line : \"*shadowcopy*\" and process.command_line : \"*delete*\") or\n    (process.pe.original_file_name : \"vssadmin.exe\" and process.command_line : \"*shadows*\" and process.command_line : \"*delete*\") or\n    (process.pe.original_file_name : \"bcdedit.exe\" and process.command_line : (\"*bootstatuspolicy*\", \"*recoveryenabled*\")) or\n    (process.pe.original_file_name : \"wbadmin.exe\" and process.command_line : (\"*catalog*\", \"*systemstatebackup*\") and process.command_line : \"*delete*\")\n    )\n",
            "rule": {
                "description": "Identifies the use of Windows commands to tamper with system recovery settings via Microsoft Office processes. Ransomware and other malware may do this to prevent system recovery.",
                "id": "58a08390-e69d-4b32-9487-1d1ddb16ba09",
                "name": "Inhibit System Recovery via Microsoft Office Process",
                "reference": [],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1047",
                            "name": "Windows Management Instrumentation",
                            "reference": "https://attack.mitre.org/techniques/T1047/",
                            "subtechnique": null
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0040",
                        "name": "Impact",
                        "reference": "https://attack.mitre.org/tactics/TA0040/"
                    },
                    "technique": [
                        {
                            "id": "T1490",
                            "name": "Inhibit System Recovery",
                            "reference": "https://attack.mitre.org/techniques/T1490/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.Ext.token.integrity_level_name == \"high\" and\n process.executable : \"?:\\\\*\\\\AppData\\\\*\\\\Temp\\\\IDC*.tmp\\\\*.exe\" and\n process.parent.name : \"ieinstal.exe\" and _arraysearch(process.parent.args, $arg, $arg : \"-Embedding\") and\n not (process.code_signature.subject_name : \"Microsoft*\" and process.code_signature.trusted == true)\n",
            "rule": {
                "description": "Identifies User Account Control (UAC) bypass attempts by abusing an elevated COM Interface to launch a malicious program. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.",
                "id": "badd95ba-2416-4785-8f7f-787952b58a1d",
                "name": "UAC Bypass Attempt via Elevated COM Internet Explorer Add-On Installer",
                "reference": [
                    "https://swapcontext.blogspot.com/2020/11/uac-bypasses-from-comautoapprovallist.html"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id with maxspan=1m\n  [process where event.action == \"start\" and\n   process.name : (\"wermgr.exe\", \"WerFault.exe\") and process.args_count == 1]\n  [network where event.action == \"connection_attempted\" and process.name : (\"wermgr.exe\", \"WerFault.exe\")]\n",
            "rule": {
                "description": "Identifies suspicious instances of the Windows Error Reporting process (WerFault.exe or Wermgr.exe) with matching command-line and process executable values performing outgoing network connections. This may be indicative of a masquerading attempt to evade suspicious child process behavior detections.",
                "id": "3d16f5f9-da4c-4b15-a501-505761b75ca6",
                "name": "Windows Error Manager/Reporting Masquerading",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1055",
                            "name": "Process Injection",
                            "reference": "https://attack.mitre.org/techniques/T1055/",
                            "subtechnique": null
                        },
                        {
                            "id": "T1036",
                            "name": "Masquerading",
                            "reference": "https://attack.mitre.org/techniques/T1036/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by user.id with maxspan=5m\n [file where event.action != \"deletion\" and\n  file.name : (\"sqlite3.dll\", \"mozcrt19.dll\", \"mozsqlite3.dll\") and\n  not file.path : (\"?:\\\\Program Files (x86)\\\\*.dll\", \"?:\\\\Program Files\\\\*.dll\")]\n [process where event.action == \"start\" and process.pe.original_file_name : \"extexport.exe\"]\n",
            "rule": {
                "description": "Identifies the execution of the built-in Windows program, ExtExport, which can be used for execution via side-loading a malicious DLL with one of the following names: mozcrt19.dll, mozsqlite3.dll, or sqlite.dll.",
                "id": "e13a65b7-f46f-4c7f-85cf-7e59170071fa",
                "name": "Execution via Internet Explorer Exporter",
                "reference": [
                    "https://lolbas-project.github.io/lolbas/Binaries/Extexport/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n [file where event.action != \"deletion\" and process.name : \"hh.exe\"] by file.path\n [process where event.action == \"start\"] by process.executable\n",
            "rule": {
                "description": "Identifies when the Microsoft HTML Help Executable (hh.exe) creates a portable executable (PE) file and the file is subsequently executed. Adversaries may conceal malicious code in a CHM file and deliver it to a victim for execution.",
                "id": "9c3b13f6-bc26-4397-9721-4ba23ddd1014",
                "name": "File Execution via Microsoft HTML Help",
                "reference": [
                    "https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.001",
                                    "name": "Compiled HTML File",
                                    "reference": "https://attack.mitre.org/techniques/T1218/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by user.id with maxspan=30s\n    [library where dll.name : (\"wmiutils.dll\", \"fastprox.dll\", \"wbemprox.dll\") and \n     process.name : (\"excel.exe\", \"powerpnt.exe\", \"winword.exe\")]\n    [process where event.action == \"start\" and\n     process.parent.name : \"wmiprvse.exe\" and\n     not process.Ext.token.integrity_level_name == \"system\" and\n     (process.pe.original_file_name :\n        (\n          \"cscript.exe\",\n          \"wscript.exe\",\n          \"PowerShell.EXE\",\n          \"Cmd.Exe\",\n          \"pwsh.exe\",\n          \"bitsadmin.exe\",\n          \"certutil.exe\",\n          \"hh.exe\",\n          \"MSHTA.EXE\",\n          \"RUNDLL32.EXE\",\n          \"REGSVR32.EXE\",\n          \"MSBuild.exe\",\n          \"InstallUtil.exe\",\n          \"RegAsm.exe\",\n          \"RegSvcs.exe\",\n          \"msxsl.exe\",\n          \"CONTROL.EXE\",\n          \"EXPLORER.EXE\",\n          \"Microsoft.Workflow.Compiler.exe\",\n          \"msiexec.exe\",\n          \"sc.exe\",\n          \"schtasks.exe\",\n          \"WMIC.exe\",\n          \"curl.exe\"\n        ) or\n      process.executable : (\"?:\\\\Users\\\\*.exe\", \"?:\\\\ProgramData\\\\*.exe\")\n     )\n    ]\n",
            "rule": {
                "description": "Identifies a suspicious image load (wmiutils.dll) from Microsoft Office processes followed by a child process spawned via Windows Management Instrumentation (WMI). This behavior may indicate adversarial activity to avoid spawning a suspicious MS Office child process.",
                "id": "46952f58-6741-4280-8e74-fa43f63c9604",
                "name": "WMI Image Load via Microsoft Office",
                "reference": [
                    "https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1047",
                            "name": "Windows Management Instrumentation",
                            "reference": "https://attack.mitre.org/techniques/T1047/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n  [process where event.action == \"start\" and\n   process.executable : \"?:\\\\Windows\\\\*\" and\n   /* usual BITS Clients */\n   not process.executable :\n           (\n             \"?:\\\\Windows\\\\system32\\\\bitsadmin.exe\",\n             \"?:\\\\Windows\\\\SysWOW64\\\\bitsadmin.exe\",\n             \"?:\\\\Windows\\\\System32\\\\MDMAppInstaller.exe\",\n             \"?:\\\\Windows\\\\System32\\\\DeviceEnroller.exe\",\n             \"?:\\\\Windows\\\\SysWOW64\\\\OneDriveSetup.exe\",\n             \"?:\\\\Windows\\\\System32\\\\ofdeploy.exe\",\n             \"?:\\\\Windows\\\\System32\\\\directxdatabaseupdater.exe\",\n             \"?:\\\\Windows\\\\System32\\\\MRT.exe\",\n             \"?:\\\\Windows\\\\System32\\\\aitstatic.exe\",\n             \"?:\\\\Windows\\\\System32\\\\desktopimgdownldr.exe\",\n             \"?:\\\\Windows\\\\System32\\\\Speech_OneCore\\\\common\\\\SpeechModelDownload.exe\",\n             \"?:\\\\Windows\\\\SysWOW64\\\\Speech_OneCore\\\\common\\\\SpeechModelDownload.exe\",\n             \"?:\\\\Windows\\\\System32\\\\RecoveryDrive.exe\",\n             \"?:\\\\Windows\\\\system32\\\\WindowsPowerShell\\\\v*\\\\powershell.exe\",\n             \"?:\\\\Windows\\\\system32\\\\WindowsPowerShell\\\\v*\\\\powershell_ise.exe\",\n             \"?:\\\\Windows\\\\SysWOW64\\\\WindowsPowerShell\\\\v*\\\\powershell.exe\",\n             \"?:\\\\Windows\\\\SysWOW64\\\\WindowsPowerShell\\\\v*\\\\powershell_ise.exe\",\n             \"?:\\\\Windows\\\\System32\\\\svchost.exe\",\n             /* Issue #293 */\n             \"?:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\",\n             \"?:\\\\Windows\\\\SysWOW64\\\\wbem\\\\WmiPrvSE.exe\",\n             \"?:\\\\Windows\\\\ccmsetup\\\\*.exe\",\n             \"?:\\\\Windows\\\\System32\\\\msiexec.exe\",\n             \"?:\\\\Windows\\\\SysWOW64\\\\msiexec.exe\",\n             \"?:\\\\Windows\\\\CCM\\\\*.exe\",\n             \"?:\\\\Windows\\\\Temp\\\\*.exe\",\n             \"?:\\\\Windows\\\\System32\\\\.local-chromium\\\\*\\\\chrome-win\\\\chrome.exe\",\n             \"?:\\\\Windows\\\\LTSvc\\\\LTSVC.exe\",\n             \"?:\\\\windows\\\\system32\\\\inetsrv\\\\w3wp.exe\",\n             \"?:\\\\windows\\\\SysWOW64\\\\inetsrv\\\\w3wp.exe\",\n             \"?:\\\\Windows\\\\System32\\\\mmc.exe\",\n             \"?:\\\\Windows\\\\SysWOW64\\\\mmc.exe\",\n             \"?:\\\\Windows\\\\System32\\\\dtuhandler.exe\"\n             ) and\n   not process.parent.executable : \"?:\\\\Windows\\\\system32\\\\ofdeploy.exe\" and \n   not (process.name : \"rundll32.exe\" and process.command_line : \"*zzzzInvokeManagedCustomActionOutOfProc*\")\n   ]\n   [library where dll.name : \"Bitsproxy.dll\"]\n",
            "rule": {
                "description": "Identifies unusual Windows Background Intelligent Transfer Service (BITS) client processes. This tactic may be indicative of malicious activity where malware is downloading or uploading data using the BITS service.",
                "id": "d7eeeca8-ee05-4d0e-b2a7-c7df697d9dc5",
                "name": "Unusual BITS Service Client Process",
                "reference": [
                    "https://blog.menasec.net/2021/05/hunting-for-suspicious-usage-of.html",
                    "https://www.elastic.co/blog/hunting-for-persistence-using-elastic-security-part-2"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1197",
                            "name": "BITS Jobs",
                            "reference": "https://attack.mitre.org/techniques/T1197/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=1m\n    [library where dll.name : \"taskschd.dll\" and\n     process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSPUB.EXE\", \"MSACCESS.EXE\")]\n    [file where event.action == \"creation\" and process.name == \"svchost.exe\" and\n     file.path : (\"?:\\\\Windows\\\\System32\\\\Tasks\\\\*\", \"?:\\\\Windows\\\\SysWOW64\\\\Tasks\\\\*\")]\n",
            "rule": {
                "description": "Identifies a suspicious image load (taskschd.dll) from Microsoft Office processes followed by immediate task creation. This behavior may indicate adversarial activity where a scheduled task is configured via Windows Component Object Model (COM). This technique can be used to configure persistence and evade monitoring by avoiding the usage of the traditional Windows binary (schtasks.exe) used to manage scheduled tasks.",
                "id": "f9fd002c-0dab-42ec-8675-0cf5af6b4a85",
                "name": "Scheduled Task Creation via Microsoft Office",
                "reference": [
                    "https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16",
                    "https://www.clearskysec.com/wp-content/uploads/2020/10/Operation-Quicksand.pdf",
                    "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1053",
                            "name": "Scheduled Task/Job",
                            "reference": "https://attack.mitre.org/techniques/T1053/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n  [process where event.action == \"start\" and\n   process.executable : \"?:\\\\Windows\\\\*.exe\" and\n   /* Issue #338 */\n   not (process.code_signature.subject_name : \"RAPIDFIRE TOOLS INC.\" and process.code_signature.trusted == true)]\n  [network where network.direction == \"outgoing\" and\n   destination.port == 445 and source.port >= 49152 and\n   not process.executable :\n                 (\"?:\\\\Windows\\\\System32\\\\MicrosoftEdgeCP.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\inetsrv\\\\w3wp.exe\",\n                  \"?:\\\\Windows\\\\SysWOW64\\\\inetsrv\\\\w3wp.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\wsmprovhost.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\mmc.exe\",\n                  \"?:\\\\Windows\\\\SysWOW64\\\\mmc.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\svchost.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\userinit.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\vpc.exe\",\n                  \"?:\\\\Windows\\\\SysWOW64\\\\vmnat.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\telnet.exe\",\n                  \"?:\\\\windows\\\\system32\\\\windowspowershell\\\\v*\\\\powershell.exe\",\n                  \"?:\\\\windows\\\\SysWOW64\\\\windowspowershell\\\\v*\\\\powershell.exe\",\n                  \"?:\\\\windows\\\\system32\\\\windowspowershell\\\\v*\\\\powershell_ise.exe\",\n                  \"?:\\\\Windows\\\\NetworkDetective-RDC-*\\\\nacmdline.exe\",\n                  \"?:\\\\Windows\\\\ProPatches\\\\Installation\\\\InstallationSandbox*\\\\stdeploy.exe\")]\n",
            "rule": {
                "description": "Identifies unexpected processes making network connections over port 445. Windows File Sharing is typically implemented over Server Message Block (SMB), which communicates between hosts using port 445. When legitimate, these network connections are established by the kernel. Processes making 445/tcp connections may be port scanners, exploits, or suspicious user-level processes moving laterally.",
                "id": "2fbbd139-3919-4b6b-9c50-9452b0aef005",
                "name": "Unusual SMB Client Process",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0008",
                        "name": "Lateral Movement",
                        "reference": "https://attack.mitre.org/tactics/TA0008/"
                    },
                    "technique": [
                        {
                            "id": "T1021",
                            "name": "Remote Services",
                            "reference": "https://attack.mitre.org/techniques/T1021/",
                            "subtechnique": [
                                {
                                    "id": "T1021.002",
                                    "name": "SMB/Windows Admin Shares",
                                    "reference": "https://attack.mitre.org/techniques/T1021/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "library where dll.name :\n  (\n  \"wlbsctrl.dll\",\n  \"wbemcomn.dll\",\n  \"WptsExtensions.dll\",\n  \"Tsmsisrv.dll\",\n  \"TSVIPSrv.dll\",\n  \"Msfte.dll\",\n  \"wow64log.dll\",\n  \"WindowsCoreDeviceInfo.dll\",\n  \"Ualapi.dll\",\n  \"wlanhlp.dll\",\n  \"phoneinfo.dll\",\n  \"EdgeGdi.dll\",\n  \"cdpsgshims.dll\",\n  \"diagtrack_win.dll\"\n  ) and not (dll.code_signature.subject_name : \"Microsoft*\" and dll.code_signature.trusted == true) and not\n  /* Issue #284 */\n  dll.path : (\"?:\\\\Windows\\\\System32\\\\wbemcomn.dll\", \"?:\\\\Windows\\\\SysWOW64\\\\wbemcomn.dll\", \"?:\\\\Windows\\\\WinSxS\\\\*\\\\wbemcomn.dll\")\n",
            "rule": {
                "description": "Identifies the loading of a non Microsoft signed DLL that is missing on a default Windows installation (phantom DLL) or one that can be loaded from a different location by a native Windows process. This may be abused to persist or elevate privileges via privileged file write vulnerabilities.",
                "id": "a2a3d803-5c25-43cc-84b9-a4ae2a4dab27",
                "name": "Suspicious ImageLoad via Untrusted DLL",
                "reference": [
                    "https://itm4n.github.io/windows-dll-hijacking-clarified/",
                    "http://remoteawesomethoughts.blogspot.com/2019/05/windows-10-task-schedulerservice.html",
                    "https://googleprojectzero.blogspot.com/2018/04/windows-exploitation-tricks-exploiting.html",
                    "https://shellz.club/edgegdi-dll-for-persistence-and-lateral-movement/",
                    "https://windows-internals.com/faxing-your-way-to-system/",
                    "http://waleedassar.blogspot.com/2013/01/wow64logdll.html"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.001",
                                    "name": "DLL Search Order Hijacking",
                                    "reference": "https://attack.mitre.org/techniques/T1574/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id with maxspan=5m\n [process where event.action == \"start\" and\n  (process.parent.name : (\"EQNEDT32.EXE\", \"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSPUB.EXE\", \"MSACCESS.EXE\") or\n   descendant of [process where event.action == \"start\" and\n                  process.name :\n                        (\"EQNEDT32.EXE\",\n                         \"WINWORD.EXE\",\n                         \"EXCEL.EXE\",\n                         \"POWERPNT.EXE\",\n                         \"MSPUB.EXE\",\n                         \"MSACCESS.EXE\")]) and\n   /* Issue #303 */\n   not process.Ext.token.integrity_level_name == \"system\"\n  ]\n [registry where registry.data.strings[0] != null and\n  registry.path : (\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\User Shell Folders\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Environment\\\\UserInitMprLogonScript\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\Load\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\Shell\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System\\\\Scripts\\\\Logoff\\\\Script\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System\\\\Scripts\\\\Logon\\\\Script\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System\\\\Scripts\\\\Shutdown\\\\Script\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System\\\\Scripts\\\\Startup\\\\Script\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Ctf\\\\LangBarAddin\\\\*\\\\FilePath\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Extensions\\\\*\\\\Exec\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Extensions\\\\*\\\\Script\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Command Processor\\\\Autorun\"\n     ) and not\n     /* Issue #303 */\n     (process.name : \"OneDriveSetup.exe\" and\n       registry.value : (\"Delete Cached Standalone Update Binary\", \"Delete Cached Update Binary\", \"amd64\", \"Uninstall *\")) and\n     not (process.name : \"Teams.exe\" and registry.value : \"com.squirrel.Teams.Teams\")]\n",
            "rule": {
                "description": "Identifies the modification of common AutoStart related registry keys descending from a Microsoft Office process. Adversaries may use this technique to maintain persistence.",
                "id": "999e7a9a-334f-4b74-834f-a652f91531f2",
                "name": "Registry Persistence via Microsoft Office Descendant Process",
                "reference": [
                    "https://docs.microsoft.com/en-us/previous-versions/technet-magazine/ee851671(v=msdn.10)"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1112",
                            "name": "Modify Registry",
                            "reference": "https://attack.mitre.org/techniques/T1112/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by user.id with maxspan=1m\n  [file where event.action != \"deletion\" and\n   (file.extension : (\"exe\", \"com\") or (file.Ext.header_data[0] == 77 and file.Ext.header_data[1] == 90)) and\n   process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\")] by file.path\n  [process where event.action == \"start\" and\n   process.parent.name : (\"powershell.exe\", \"pwsh.exe\", \"cmd.exe\", \"cscript.exe\", \"wscript.exe\")] by process.executable\n",
            "rule": {
                "description": "Identifies the execution of an unsigned file written or modified by Microsoft Office processes via a Windows Shell process.",
                "id": "54aabea0-3687-4ef1-b70c-015ca588e563",
                "name": "Microsoft Office File Execution via Script Interpreter",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.pe.original_file_name in (\"cscript.exe\", \"wscript.exe\") and process.args_count >= 4 and\n /* Issue 259 - additional rule strictness */\n process.command_line : (\"*localhost*script:http*\", \"*127.0.0.*script:http*\")\n",
            "rule": {
                "description": "Adversaries may use the trusted PubPrn script to proxy execution of malicious files. This behavior may bypass signature validation restrictions and application control solutions that do not account for use of these scripts.",
                "id": "0d4454a7-c682-4085-995c-300973c5bdea",
                "name": "Scriptlet Proxy Execution via PubPrn",
                "reference": [
                    "https://lolbas-project.github.io/lolbas/Scripts/Pubprn/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1216",
                            "name": "Signed Script Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1216/",
                            "subtechnique": [
                                {
                                    "id": "T1216.001",
                                    "name": "PubPrn",
                                    "reference": "https://attack.mitre.org/techniques/T1216/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n  [file where event.action == \"rename\" and\n   process.name : \"dllhost.exe\" and\n   file.path : (\"?:\\\\Program Files\\\\Windows Media Player\\\\*.dll\", \"?:\\\\Program Files (x86)\\\\Windows Media Player\\\\*.dll\")]\n  [process where event.action == \"start\" and\n   process.Ext.token.integrity_level_name : (\"high\", \"system\") and\n   process.executable : (\"?:\\\\Program Files\\\\Windows Media Player\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\Windows Media Player\\\\*.dll\")]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via DLL side-loading from the trusted Windows Media Player folder. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.",
                "id": "2aac12a2-23e7-4557-950e-a7b9ab96a26d",
                "name": "UAC Bypass Attempt via DLL Side-Loading from Windows Media Player Folder",
                "reference": [
                    "https://github.com/hfiref0x/UACME"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.002",
                                    "name": "DLL Side-Loading",
                                    "reference": "https://attack.mitre.org/techniques/T1574/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  process.name : (\"wscript.exe\",\n                  \"cscript.exe\",\n                  \"rundll32.exe\",\n                  \"regsvr32.exe\",\n                  \"cmstp.exe\",\n                  \"RegAsm.exe\",\n                  \"installutil.exe\",\n                  \"mshta.exe\",\n                  \"RegSvcs.exe\",\n                  \"msbuild.exe\",\n                  \"msxsl.exe\",\n                  \"xwizard.exe\") and\n  /* add suspicious execution paths here */\n  _arraysearch(process.args, $arg, $arg  :\n                 (\"?:\\\\PerfLogs\\\\*\",\n                  \"?:\\\\Users\\\\*\\\\Documents\\\\*\",\n                  \"?:\\\\Users\\\\*\\\\Pictures\\\\*\",\n                  \"?:\\\\Users\\\\*\\\\Music\\\\*\",\n                  \"?:\\\\Users\\\\Public\\\\*\",\n                  \"?:\\\\Users\\\\Default\\\\*\",\n                  \"?:\\\\Windows\\\\Tasks\\\\*\",\n                  \"?:\\\\Windows\\\\System32\\\\Tasks\\\\*\",\n                  \"?:\\\\Intel\\\\*\",\n                  \"?:\\\\AMD\\\\Temp\\\\*\",\n                  \"?:\\\\Windows\\\\AppReadiness\\\\*\",\n                  \"?:\\\\Windows\\\\ServiceState\\\\*\",\n                  \"?:\\\\Windows\\\\security\\\\*\",\n                  \"?:\\\\Windows\\\\IdentityCRL\\\\*\",\n                  \"?:\\\\Windows\\\\Branding\\\\*\",\n                  \"?:\\\\Windows\\\\csc\\\\*\",\n                  \"?:\\\\Windows\\\\DigitalLocker\\\\*\",\n                  \"?:\\\\Windows\\\\en-US\\\\*\",\n                  \"?:\\\\Windows\\\\wlansvc\\\\*\",\n                  \"?:\\\\Windows\\\\Prefetch\\\\*\",\n                  \"?:\\\\Windows\\\\Fonts\\\\*\",\n                  \"?:\\\\Windows\\\\diagnostics\\\\*\",\n                  \"?:\\\\Windows\\\\TAPI\\\\*\",\n                  \"?:\\\\Windows\\\\INF\\\\*\",\n                  \"?:\\\\windows\\\\tracing\\\\*\",\n                  \"?:\\\\windows\\\\IME\\\\*\",\n                  \"?:\\\\Windows\\\\Performance\\\\*\",\n                  \"?:\\\\windows\\\\intel\\\\*\",\n                  \"?:\\\\windows\\\\ms\\\\*\",\n                  \"?:\\\\Windows\\\\dot3svc\\\\*\",\n                  \"?:\\\\Windows\\\\ServiceProfiles\\\\*\",\n                  \"?:\\\\Windows\\\\panther\\\\*\",\n                  \"?:\\\\Windows\\\\RemotePackages\\\\*\",\n                  \"?:\\\\Windows\\\\OCR\\\\*\",\n                  \"?:\\\\Windows\\\\appcompat\\\\*\",\n                  \"?:\\\\Windows\\\\apppatch\\\\*\",\n                  \"?:\\\\Windows\\\\addins\\\\*\",\n                  \"?:\\\\Windows\\\\Setup\\\\*\",\n                  \"?:\\\\Windows\\\\Help\\\\*\",\n                  \"?:\\\\Windows\\\\SKB\\\\*\",\n                  \"?:\\\\Windows\\\\Vss\\\\*\",\n                  \"?:\\\\Windows\\\\Web\\\\*\",\n                  \"?:\\\\Windows\\\\servicing\\\\*\",\n                  \"?:\\\\Windows\\\\CbsTemp\\\\*\",\n                  \"?:\\\\Windows\\\\Logs\\\\*\",\n                  \"?:\\\\Windows\\\\WaaS\\\\*\",\n                  \"?:\\\\Windows\\\\twain_32\\\\*\",\n                  \"?:\\\\Windows\\\\ShellExperiences\\\\*\",\n                  \"?:\\\\Windows\\\\ShellComponents\\\\*\",\n                  \"?:\\\\Windows\\\\PLA\\\\*\",\n                  \"?:\\\\Windows\\\\Migration\\\\*\",\n                  \"?:\\\\Windows\\\\debug\\\\*\",\n                  \"?:\\\\Windows\\\\Cursors\\\\*\",\n                  \"?:\\\\Windows\\\\Containers\\\\*\",\n                  \"?:\\\\Windows\\\\Boot\\\\*\",\n                  \"?:\\\\Windows\\\\bcastdvr\\\\*\",\n                  \"?:\\\\Windows\\\\TextInput\\\\*\",\n                  \"?:\\\\Windows\\\\schemas\\\\*\",\n                  \"?:\\\\Windows\\\\SchCache\\\\*\",\n                  \"?:\\\\Windows\\\\Resources\\\\*\",\n                  \"?:\\\\Windows\\\\rescache\\\\*\",\n                  \"?:\\\\Windows\\\\Provisioning\\\\*\",\n                  \"?:\\\\Windows\\\\PrintDialog\\\\*\",\n                  \"?:\\\\Windows\\\\PolicyDefinitions\\\\*\",\n                  \"?:\\\\Windows\\\\media\\\\*\",\n                  \"?:\\\\Windows\\\\Globalization\\\\*\",\n                  \"?:\\\\Windows\\\\L2Schemas\\\\*\",\n                  \"?:\\\\Windows\\\\LiveKernelReports\\\\*\",\n                  \"?:\\\\Windows\\\\ModemLogs\\\\*\",\n                  \"?:\\\\Windows\\\\ImmersiveControlPanel\\\\*\",\n                  \"?:\\\\$Recycle.Bin\\\\*\")) and not\n    (process.name : \"rundll32.exe\" and process.command_line : (\"*uxtheme.dll,#64*\", \"*PRINTUI.DLL,PrintUIEntry*\")) and not\n    /* Issue #322 */\n    (process.name : \"rundll32.exe\" and \n     process.command_line : (\"*cryptext.dll*\", \"*:\\\\Users\\\\*\\\\Documents\\\\DocuShare\\\\*\", \"*dfshim.dll*ShOpenVerbShortcut*\")) and not\n    (process.name : \"cscript.exe\" and process.command_line : \"*PerfLogs\\\\*\\\\ServerManager*\") and not \n    (process.name : \"regsvr32.exe\" and process.command_line : \"*:\\\\WINDOWS\\\\Help\\\\*\" and \n     process.parent.executable : (\"?:\\\\Program Files (x86)\\\\Hewlett-Packard\\\\*.exe\", \n                                  \"?:\\\\Program Files\\\\Hewlett-Packard\\\\*.exe\",\n                                  \"?:\\\\Program Files (x86)\\\\HP\\\\*.exe\",\n                                  \"?:\\\\Program Files\\\\HP\\\\*.exe\"))\n",
            "rule": {
                "description": "Identifies process execution from suspicious default Windows directories. This may be abused by adversaries to hide malware in trusted paths.",
                "id": "16c84e67-e5e7-44ff-aefa-4d771bcafc0c",
                "name": "Execution from Unusual Directory",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": null
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence\n [process where event.action == \"start\" and\n  process.Ext.token.integrity_level_name in (\"medium\", \"low\") and \n  /* Issue #328 */\n  not (process.name : \"slack.exe\" and process.code_signature.trusted == true) and\n  not (process.code_signature.subject_name : \"Valve\" and process.code_signature.trusted == true)\n  ] by process.entity_id\n [process where event.action == \"start\" and\n  process.Ext.token.integrity_level_name == \"system\" and \n  /* Issue #328 */\n  not process.executable : \"?:\\\\Windows\\\\System32\\\\conhost.exe\"] by process.parent.entity_id\n",
            "rule": {
                "description": "Identifies the execution of a process with an integrity level of SYSTEM from a parent process with an integrity level of Low or Medium. This behavior is consistent with a successful exploit to escalate privileges and create a process with SYSTEM privileges.",
                "id": "9ac68ab0-d251-4c84-a8df-85779ccc728f",
                "name": "Unusual Child Process Integrity Level",
                "reference": [
                    "https://bsodtutorials.wordpress.com/2014/07/31/windows-integrity-levels-process-explorer-and-windbg/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1134",
                            "name": "Access Token Manipulation",
                            "reference": "https://attack.mitre.org/techniques/T1134/",
                            "subtechnique": [
                                {
                                    "id": "T1134.002",
                                    "name": "Create Process with Token",
                                    "reference": "https://attack.mitre.org/techniques/T1134/002/"
                                }
                            ]
                        },
                        {
                            "id": "T1068",
                            "name": "Exploitation for Privilege Escalation",
                            "reference": "https://attack.mitre.org/techniques/T1068/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by user.id with maxspan=1m\n  [file where event.action != \"deletion\" and\n    (file.extension : (\"exe\", \"com\") or (file.Ext.header_data[0] == 77 and file.Ext.header_data[1] == 90)) and\n    process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\") and\n    not file.path : (\n               \"?:\\\\Users\\\\*\\\\Desktop\\\\*\",\n               \"?:\\\\Users\\\\*\\\\Downloads\\\\*\",\n               \"?:\\\\Users\\\\*\\\\Documents\\\\*\",\n               \"?:\\\\Users\\\\*\\\\AppData\\\\Local\\\\Temp\\\\*-*-*-*\\\\*\",\n               \"?:\\\\Program Files (x86)\\\\*\",\n               \"?:\\\\Program Files\\\\*\"\n             )\n    ] by file.path\n  [process where event.action == \"start\" and\n    process.parent.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\") and\n    process.code_signature.trusted == true and\n    not (\n        (\n          process.pe.original_file_name in (\"ZoomIt.exe\", \"setup.exe\", \"Setup.exe\", \"SFXCAB.EXE\") and\n          process.code_signature.subject_name == \"Microsoft Corporation\"\n\t    ) or\n\t      process.code_signature.subject_name in\n\t        (\n\t          \"Add-in Express\",\n\t          \"Adaptive Insights LLC\",\n\t           \"Adaptive Insights, Inc.\",\n\t           \"Beijing Yundong Zhixiao Network Technology Co. , Ltd.\",\n\t           \"Dynamo Software, Inc.\",\n\t           \"Environmental Systems Research Institute Inc.\",\n\t           \"Essential Objects, Inc.\",\n\t           \"iSpring Solutions, Inc.\",\n\t           \"Insightsoftware.Com, Inc.\",\n\t           \"JPMorgan Chase and Co.\",\n\t           \"KNOWLEDGE MANAGEMENT ASSOCIATES, LLC\",\n\t           \"Poll Everywhere, Inc.\",\n\t           \"PitchBook Data, Inc.\",\n\t           \"Tagetik Software Srl\",\n\t           \"SAS Institute, Inc.\",\n\t           \"Thomson Reuters Corporation\",\n\t           \"TEAMDEV LTD.\",\n\t           \"Vena Solutions Canada Inc.\",\n\t           \"Zhuhai Kingsoft Office Software Co., Ltd.\",\n\t           \"Citrix Systems, Inc.\"\n\t        )\n    )\n    ] by process.executable\n",
            "rule": {
                "description": "Identifies the execution of a signed file written or modified by a Microsoft Office process. This may indicate an attempt to side-load a DLL or execute signed malware.",
                "id": "321e7877-075a-4582-8eff-777dde15e787",
                "name": "Signed Binary Execution via Microsoft Office",
                "reference": [],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.002",
                                    "name": "DLL Side-Loading",
                                    "reference": "https://attack.mitre.org/techniques/T1574/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.Ext.token.integrity_level_name == \"high\" and\n _arraysearch(process.args, $arg, $arg : \"/autoclean\") and _arraysearch(process.args, $arg, $arg : \"/d\") and\n not process.executable : (\"?:\\\\Windows\\\\System32\\\\cleanmgr.exe\",\n                           \"?:\\\\Windows\\\\SysWOW64\\\\cleanmgr.exe\",\n                           \"?:\\\\Windows\\\\System32\\\\taskhostw.exe\")\n",
            "rule": {
                "description": "Identifies User Account Control (UAC) bypass attempts via hijacking the DiskCleanup scheduled task. Attackers bypass UAC to stealthily execute code with elevated permissions.",
                "id": "d487049e-381d-44ad-9ec9-d23e88dbf573",
                "name": "UAC Bypass via DiskCleanup Scheduled Task Hijack",
                "reference": [
                    "https://www.tiraniddo.dev/2017/05/exploiting-environment-variables-in.html"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  ((process.pe.original_file_name : \"7z.exe\" and not process.name : \"*7z*.exe\" and not process.name : \"sevnz*.exe\") or\n  (process.pe.original_file_name : \"7za.exe\" and not process.name : \"*7z*.exe\") or\n  (process.pe.original_file_name : \"procdump\" and process.code_signature.subject_name == \"Microsoft Corporation\" and not process.name : \"*procdump*.exe\") or\n  (process.pe.original_file_name : \"psexec.c\" and process.code_signature.subject_name == \"Microsoft Corporation\" and not process.name : \"*psexec*.exe\") or\n  (process.pe.original_file_name : \"strings.exe\" and process.code_signature.subject_name == \"Microsoft Corporation\" and not process.name : \"*strings*.exe\") or\n  (process.pe.original_file_name : \"movefile\" and process.code_signature.subject_name == \"Microsoft Corporation\" and not process.name : \"*move*.exe\") or\n  (process.pe.original_file_name : \"pendmoves.exe\" and process.code_signature.subject_name == \"Microsoft Corporation\" and not process.name : \"*pendmoves*.exe\") or\n  (process.pe.original_file_name : \"sdelete.exe\" and process.code_signature.subject_name == \"Microsoft Corporation\" and not process.name : \"*sdelete*\")) and\n    not process.executable :\n    (\n      \"?:\\\\Windows\\\\System32\\\\*.exe\",\n      \"?:\\\\Windows\\\\SysWOW64\\\\*.exe\",\n      \"?:\\\\Program Files (x86)\\\\*.exe\",\n      \"?:\\\\Program Files\\\\*.exe\"\n    )\n",
            "rule": {
                "description": "Identifies third party administrative tools commonly used by adversaries but running with unexpected file names.",
                "id": "b707de5c-8e4d-4d2c-be22-b09a7e82b73f",
                "name": "Renamed Third Party Administrator Tools",
                "reference": [],
                "severity": "low",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1036",
                            "name": "Masquerading",
                            "reference": "https://attack.mitre.org/techniques/T1036/",
                            "subtechnique": [
                                {
                                    "id": "T1036.003",
                                    "name": "Rename System Utilities",
                                    "reference": "https://attack.mitre.org/techniques/T1036/003/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=1m\n  [process where event.action == \"start\" and process.code_signature.trusted != true and not\n   process.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\")] by process.entity_id\n  [process where event.action == \"start\" and process.name : \"netsh.exe\" and\n   process.command_line : \"*add*allowedprogram*ENABLE*\"] by process.parent.entity_id\n",
            "rule": {
                "description": "Identifies the execution of the built-in Windows program, Netsh, to add a program to the Windows Firewall exception list via an untrusted parent process.",
                "id": "5c01669c-e1cc-4acc-95b6-8b5e4a92c970",
                "name": "Windows Firewall Exception List Modified via Untrusted Process",
                "reference": [
                    "https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/netsh-advfirewall-firewall-control-firewall-behavior"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1562",
                            "name": "Impair Defenses",
                            "reference": "https://attack.mitre.org/techniques/T1562/",
                            "subtechnique": [
                                {
                                    "id": "T1562.004",
                                    "name": "Disable or Modify System Firewall",
                                    "reference": "https://attack.mitre.org/techniques/T1562/004/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and process.executable : \"C:\\\\*\" and\n  (process.working_directory : \"?:\\\\\" and not process.working_directory : \"C:\\\\\") and\n  process.parent.name : \"explorer.exe\" and\n  process.name : (\"rundll32.exe\", \"mshta.exe\", \"powershell.exe\", \"pwsh.exe\", \"cmd.exe\", \"regsvr32.exe\",\n                  \"cscript.exe\", \"wscript.exe\") and\n  /* Issue #316 */\n  process.args_count >= 2\n",
            "rule": {
                "description": "Identifies when a script interpreter or signed binary is launched via a non-standard working directory. An attacker may use this technique to evade defenses.",
                "id": "42d2bbfb-a2fb-4327-b701-89ead6044ca1",
                "name": "Suspicious Execution from a Mounted Device",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                },
                                {
                                    "id": "T1218.005",
                                    "name": "Mshta",
                                    "reference": "https://attack.mitre.org/techniques/T1218/005/"
                                },
                                {
                                    "id": "T1218.010",
                                    "name": "Regsvr32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/010/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                },
                                {
                                    "id": "T1059.003",
                                    "name": "Windows Command Shell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/003/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "sequence by process.entity_id with maxspan=1m\n [process where event.action == \"start\" and process.pe.original_file_name == \"RUNDLL32.EXE\" and\n  process.command_line : \"*advpack*LaunchINFSection*\"]\n [library where dll.name : \"scrobj.dll\"]\n",
            "rule": {
                "description": "Identifies when scrobj.dll is loaded into rundll32.exe. An adversary may abuse rundll32.exe to proxy execution of malicious code.",
                "id": "93438ae3-becd-43fa-81de-645ce17afa8e",
                "name": "Scriptlet Execution via Rundll32",
                "reference": [
                    "https://lolbas-project.github.io/lolbas/Libraries/Ieadvpack/",
                    "https://lolbas-project.github.io/lolbas/Libraries/Advpack/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=1m\n  [file where event.action == \"creation\" and\n   process.name : (\"winrar.exe\", \"7zFM.exe\") and\n   file.extension : (\"lnk\", \"url\") and\n   file.path : (\"?:\\\\*\\\\Temp\\\\7z*\\\\*\", \"?:\\\\*\\\\Temp\\\\Rar$*\\\\*\")] by process.entity_id\n  [process where event.action == \"start\" and\n   process.parent.name : (\"winrar.exe\", \"7zFM.exe\") and\n   process.name : (\"cmd.exe\", \"powershell.exe\", \"pwsh.exe\")] by process.parent.entity_id\n",
            "rule": {
                "description": "Identifies the execution of a script or program extracted from within a Windows shortcut (lnk) file. Adversaries may embed malicious scripts or files in a shortcut file before delivering it to their target in order to trick them into executing the payload.",
                "id": "1a88b997-bcae-430a-8a24-7378e8bf5cc4",
                "name": "Shell Execution via Windows Shortcut File",
                "reference": [
                    "https://docs.google.com/presentation/d/13SsBd0wI0PpyH5C8WlnE_DsJjy1KxAjZ5Dmke9FHfRE/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                },
                                {
                                    "id": "T1566.002",
                                    "name": "Spearphishing Link",
                                    "reference": "https://attack.mitre.org/techniques/T1566/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.003",
                                    "name": "Windows Command Shell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/003/"
                                },
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                }
                            ]
                        },
                        {
                            "id": "T1204",
                            "name": "User Execution",
                            "reference": "https://attack.mitre.org/techniques/T1204/",
                            "subtechnique": [
                                {
                                    "id": "T1204.001",
                                    "name": "Malicious Link",
                                    "reference": "https://attack.mitre.org/techniques/T1204/001/"
                                },
                                {
                                    "id": "T1204.002",
                                    "name": "Malicious File",
                                    "reference": "https://attack.mitre.org/techniques/T1204/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n (process.pe.original_file_name : \"regsvr32.exe\" or process.name : \"regsvr32.exe\") and\n  (\n    (process.command_line : \"*scrobj*\" and process.command_line : (\"* /i:*\", \"* -i:*\", \"*.sct*\")) or\n      /* attackers may rename scrobj.dll */\n      (\n        process.command_line : \"* /u*\" and\n        process.command_line :\n          (\n            \"* /i:C:\\\\*\",\n            \"* /i:\\\"C:\\\\*\",\n            \"* -i:C:\\\\*\",\n            \"* -i:\\\"C:\\\\*\",\n            \"* /i:*http*\",\n            \"* -i:*http*\"\n          )\n      )\n  ) and\n  /* Issue #326 */\n  not (process.Ext.token.integrity_level_name == \"system\" and not process.command_line : \"*scrobj.dll*\") and\n  not process.command_line : (\"*:\\\\Program Files\\\\*\", \"*:\\\\Program Files (x86)\\\\*\") and\n  not (process.parent.executable : (\"?:\\\\Windows\\\\SysWOW64\\\\msiexec.exe\", \"?:\\\\Windows\\\\system32\\\\msiexec.exe\") and\n      not process.command_line : \"*scrobj.dll*\")\n",
            "rule": {
                "description": "Identifies the native Windows tool, regsvr32.exe, executing a scriptlet file. This can allow an attacker to bypass whitelisting and run arbitrary scripts.",
                "id": "0524c24c-e45e-4220-b21a-abdba0c46c4d",
                "name": "Regsvr32 Scriptlet Execution",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.010",
                                    "name": "Regsvr32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/010/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=2m\n  [ file where event.action != \"deletion\" and\n      process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\") and\n      // Match Windows PE files by header data (MZ)\n      file.Ext.header_data[0] == 77 and\n      file.Ext.header_data[1] == 90 and\n      not file.extension : (\"exe\", \"com\") ] by file.path\n  [ process where event.action == \"start\" ] by process.executable\n",
            "rule": {
                "description": "Identifies when a Microsoft Office process creates a portable executable (PE) file and the file is subsequently executed. An adversary may deliver a weaponized Office document to their target that writes and executes a malicious PE file.",
                "id": "901f0c30-a7c5-40c5-80e3-a50c6744632f",
                "name": "Execution of File Written or Modified by Microsoft Office",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                },
                                {
                                    "id": "T1566.002",
                                    "name": "Spearphishing Link",
                                    "reference": "https://attack.mitre.org/techniques/T1566/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  process.name : (\n    \"at.exe\",\n    \"atbroker.exe\",\n    \"arp.exe\",\n    \"bcdedit.exe\",\n    \"bitsadmin.exe\",\n    \"cdb.exe\",\n    \"cmd.exe\",\n    \"certutil.exe\",\n    \"cmstp.exe\",\n    \"conhost.exe\",\n    \"control.exe\",\n    \"cscript.exe\",\n    \"csrss.exe\",\n    \"csi.exe\",\n    \"dsget.exe\",\n    \"dfsvc.exe\",\n    \"dllhost.exe\",\n    \"dsquery.exe\",\n    \"eventvwr.exe\",\n    \"fsutil.exe\",\n    \"hostname.exe\",\n    \"ieexec.exe\",\n    \"installutil.exe\",\n    \"ipconfig.exe\",\n    \"lsass.exe\",\n    \"Microsoft.Workflow.Compiler.exe\",\n    \"mmc.exe\",\n    \"msbuild.exe\",\n    \"msdt.exe\",\n    \"mshta.exe\",\n    \"msiexec.exe\",\n    \"msxsl.exe\",\n    \"net.exe\",\n    \"net1.exe\",\n    \"netsh.exe\",\n    \"netstat.exe\",\n    \"odbcconf.exe\",\n    \"ping.exe\",\n    \"powershell.exe\",\n    \"pwsh.exe\",\n    \"qprocess.exe\",\n    \"quser.exe\",\n    \"qwinsta.exe\",\n    \"reg.exe\",\n    \"regasm.exe\",\n    \"regsvcs.exe\",\n    \"regsvr32.exe\",\n    \"runas.exe\",\n    \"rundll32.exe\",\n    \"sc.exe\",\n    \"schtasks.exe\",\n    \"sdclt.exe\",\n    \"services.exe\",\n    \"spoolsv.exe\",\n    \"svchost.exe\",\n    \"taskhost.exe\",\n    \"taskhostw.exe\",\n    \"tasklist.exe\",\n    \"userinit.exe\",\n    \"vaultcmd.exe\",\n    \"vssadmin.exe\",\n    \"wininit.exe\",\n    \"winlogon.exe\",\n    \"whoami.exe\",\n    \"wmic.exe\",\n    \"wevtutil.exe\",\n    \"wscript.exe\",\n    \"gprslt.exe\",\n    \"nbtstat.exe\",\n    \"systeminfo.exe\",\n    \"wuauclt.exe\",\n    \"VsJITDebugger.exe\",\n    \"extexport.exe\",\n    \"extexport.exe\") and\nnot process.executable : (\n  \"?:\\\\Windows\\\\System32\\\\*.exe\",\n  \"?:\\\\Windows\\\\SysWOW64\\\\*.exe\",\n  \"?:\\\\Windows\\\\Microsoft.NET\\\\*.exe\",\n  \"?:\\\\Program Files (x86)\\\\*.exe\",\n  \"?:\\\\Program Files\\\\*.exe\",\n\n  /* Remove false positvies from third parties */\n  \"?:\\\\ProgramData\\\\Lenovo\\\\ImController\\\\Plugins\\\\*.exe\",\n  \"?:\\\\cygwin*\\\\bin\\\\*.exe\",\n\n  /* Issue # 295 */\n  \"?:\\\\Users\\\\*\\\\AppData\\\\Local\\\\Programs\\\\Git\\\\usr\\\\bin\\\\hostname.exe\",\n  \"?:\\\\*\\\\usr\\\\bin\\\\hostname.exe\",\n  \"?:\\\\Packages\\\\Plugins\\\\Microsoft.GuestConfiguration.ConfigurationforWindows\\\\*\\\\pwsh.exe\",\n  \"?:\\\\ProgramData\\\\West Wind Technologies\\\\Uninstall\\\\*\\\\regsvr32.exe\",\n  \"?:\\\\ProgramData\\\\chocolatey\\\\*.exe\",\n  \"?:\\\\Users\\\\*\\\\scoop\\\\*\\\\pwsh.exe\"\n  ) and\n  not (process.name : \"certutil.exe\" and process.parent.executable : \"?:\\\\Program Files (x86)\\\\Netskope\\\\STAgent\\\\stAgentUI.exe\")\n",
            "rule": {
                "description": "Identifies binaries that have been identically named to Windows built-in programs and being run from untrusted paths. Adversaries may attempt to manipulate the name of a task or service to make it appear legitimate or benign.",
                "id": "35dedf0c-8db6-4d70-b2dc-a133b808211f",
                "name": "Binary Masquerading via Untrusted Path",
                "reference": [],
                "severity": "low",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1036",
                            "name": "Masquerading",
                            "reference": "https://attack.mitre.org/techniques/T1036/",
                            "subtechnique": [
                                {
                                    "id": "T1036.004",
                                    "name": "Masquerade Task or Service",
                                    "reference": "https://attack.mitre.org/techniques/T1036/004/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  (process.name : \"bcdedit.exe\" or process.pe.original_file_name : \"bcdedit.exe\") and\n  _arraysearch(process.args, $arg, $arg : (\"minimal\", \"network\", \"safebootalternateshell\")) and\n    descendant of\n      [process where event.action == \"start\" and\n        (process.code_signature.trusted == false or\n        process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\", \"MSPUB.EXE\",\n                        \"OUTLOOK.EXE\", \"fltldr.exe\", \"cscript.exe\", \"powershell.exe\", \"pwsh.exe\",\n                        \"wscript.exe\", \"cmd.exe\", \"rundll32.exe\", \"regsvr32.exe\", \"mshta.exe\",\n                        \"msbuild.exe\"))\n      ]\n",
            "rule": {
                "description": "Identifies when the command-line tool for managing Boot Configuration Data (BCDEdit.exe) is spawned from an untrusted process, office application, or script interpreter and used to specify a reboot into Safe Mode.",
                "id": "6d660b32-23bf-434b-a588-1cdc91224664",
                "name": "BCDEdit Safe Mode Command Execution",
                "reference": [
                    "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/",
                    "https://community.spiceworks.com/how_to/94471-how-to-reboot-into-safe-mode-at-a-command-prompt"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0040",
                        "name": "Impact",
                        "reference": "https://attack.mitre.org/tactics/TA0040/"
                    },
                    "technique": [
                        {
                            "id": "T1490",
                            "name": "Inhibit System Recovery",
                            "reference": "https://attack.mitre.org/techniques/T1490/",
                            "subtechnique": null
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                },
                                {
                                    "id": "T1059.003",
                                    "name": "Windows Command Shell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/003/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.010",
                                    "name": "Regsvr32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/010/"
                                },
                                {
                                    "id": "T1218.005",
                                    "name": "Mshta",
                                    "reference": "https://attack.mitre.org/techniques/T1218/005/"
                                },
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "registry where registry.data.strings[0] != null and\n not user.id : \"S-1-5-18\" and\n registry.path : (\"HKEY_USERS\\\\*\\\\Environment\\\\windir\", \"HKEY_USERS\\\\*\\\\Environment\\\\systemroot\") and\n not _arraysearch(registry.data.strings, $arg, $arg : (\"?:\\\\windows\", \"?SystemRoot?\"))\n",
            "rule": {
                "description": "Identifies a privilege escalation attempt via a rogue Windows directory (Windir) or System Root environment variable. This is a known primitive that is often combined with other vulnerabilities to elevate privileges.",
                "id": "18ffee0c-5f40-4dd8-aa9a-28251a308dbc",
                "name": "Privilege Escalation via Windir or SystemRoot Environment Variable",
                "reference": [
                    "https://www.tiraniddo.dev/2017/05/exploiting-environment-variables-in.html"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.007",
                                    "name": "Path Interception by PATH Environment Variable",
                                    "reference": "https://attack.mitre.org/techniques/T1574/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n [file where event.action : \"rename\" and process.name : \"dllhost.exe\" and\n  file.path : (\"?:\\\\*\\\\consent.exe.*\\\\*.dll\", \"?:\\\\*\\\\consent.exe.*\\\\*.dll\")]\n [process where event.action == \"start\" and\n  process.parent.name : \"consent.exe\" and process.Ext.token.integrity_level_name == \"system\" and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\System32\\\\wermgr.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\wermgr.exe\")]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via DLL search order hijacking. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.",
                "id": "39827014-4836-498e-8b16-bf62f7aae4bf",
                "name": "UAC Bypass Attempt via Consent DLL Search Order Hijacking",
                "reference": [
                    "https://github.com/hfiref0x/UACME",
                    "https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-redirection"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.001",
                                    "name": "DLL Search Order Hijacking",
                                    "reference": "https://attack.mitre.org/techniques/T1574/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1129",
                            "name": "Shared Modules",
                            "reference": "https://attack.mitre.org/techniques/T1129/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n  [file where file.path : \"?:\\\\*\\\\system32\\\\npmproxy.dll\" and\n   not file.path : (\"?:\\\\Windows\\\\System32\\\\npmproxy.dll\", \"?:\\\\Windows\\\\SysWOW64\\\\npmproxy.dll\")]\n  [process where event.action == \"start\" and\n   process.parent.name : \"taskhostw.exe\" and process.Ext.token.integrity_level_name == \"high\"]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via CDSSync scheduled task hijack by modifying the system root environment variable leading to loading a malicious npmproxy.dll module. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.",
                "id": "d8b7a157-c98f-42bd-8aac-7d1e4fcd53f4",
                "name": "UAC Bypass Attempt via CDSSync Scheduled Task Hijack",
                "reference": [
                    "https://github.com/AzAgarampur/byeintegrity5-uac"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.002",
                                    "name": "DLL Side-Loading",
                                    "reference": "https://attack.mitre.org/techniques/T1574/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "sequence by process.entity_id with maxspan=1m\n  [process where event.action == \"start\" and process.args_count == 1 and\n   process.name :\n     (\"AddInProcess.exe\",\n      \"AddInProcess32.exe\",\n      \"AddInUtil.exe\",\n      \"AppLaunch.exe\",\n      \"aspnet_compiler.exe\",\n      \"aspnet_regbrowsers.exe\",\n      \"aspnet_regiis.exe\",\n      \"aspnet_regsql.exe\",\n      \"aspnet_state.exe\",\n      \"aspnet_wp.exe\",\n      \"CasPol.exe\",\n      \"ComSvcConfig.exe\",\n      \"csc.exe\",\n      \"cvtres.exe\",\n      \"DataSvcUtil.exe\",\n      \"EdmGen.exe\",\n      \"ilasm.exe\",\n      \"InstallUtil.exe\",\n      \"jsc.exe\",\n      \"Microsoft.Workflow.Compiler.exe\",\n      \"MSBuild.exe\",\n      \"mscorsvw.exe\",\n      \"ngen.exe\",\n      \"ngentask.exe\",\n      \"RegAsm.exe\",\n      \"RegSvcs.exe\",\n      \"ServiceModelReg.exe\",\n      \"vbc.exe\",\n      \"WsatConfig.exe\",\n      \"dllhost.exe\",\n      \"regsvr32.exe\",\n      \"GPUpdate.exe\",\n      \"SearchProtocolHost.exe\")]\n  [network where true]\n",
            "rule": {
                "description": "Identifies suspicious network connections from Windows processes that typically have more than one command line argument. This may be indicative of a masquerading attempt to evade detections that monitor for suspicious parent-child process relationships.",
                "id": "95601d8b-b969-4189-9744-090140ae29e6",
                "name": "Network Connection via Process with Unusual Arguments",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1055",
                            "name": "Process Injection",
                            "reference": "https://attack.mitre.org/techniques/T1055/",
                            "subtechnique": null
                        },
                        {
                            "id": "T1036",
                            "name": "Masquerading",
                            "reference": "https://attack.mitre.org/techniques/T1036/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n [registry where\n  registry.path : (\"HKEY_USERS\\\\S-1-5-21-*Classes\\\\*\\\\Shell\\\\open\\\\command\\\\DelegateExecute\", \"*\\\\ms-windows-store*\")]\n [process where event.action == \"start\" and process.parent.name : \"WSReset.exe\" and\n  process.Ext.token.integrity_level_name == \"high\" and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\System32\\\\mmc.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\mmc.exe\",\n            \"?:\\\\Windows\\\\system32\\\\conhost.exe\",\n            \"?:\\\\Windows\\\\SysWOW6\\\\conhost.exe\")]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via WSReset execution hijack. Attackers bypass UAC to stealthily execute code with elevated permissions.",
                "id": "11c67af9-9599-4800-9e84-bd38f2a51581",
                "name": "UAC Bypass via WSReset Execution Hijack",
                "reference": [
                    "https://github.com/hfiref0x/UACME"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  descendant of [process where event.action == \"start\" and\n                 process.name:\n                    ( \n\t\t\t\t\t \"rundll32.exe\", \n\t\t\t\t\t \"cscript.exe\", \n\t\t\t\t\t \"wscript.exe\", \n\t\t\t\t\t \"regsvr32.exe\", \n\t\t\t\t\t \"regasm.exe\", \n\t\t\t\t\t \"regsvcs.exe\", \n\t\t\t\t\t \"installutil.exe\", \n\t\t\t\t\t \"mshta.exe\", \n\t\t\t\t\t \"cmstp.exe\", \n\t\t\t\t\t \"msxsl.exe\", \n\t\t\t\t\t \"Microsoft.Workflow.Compiler.exe\", \n\t\t\t\t\t \"ieexec.exe\", \n\t\t\t\t\t \"iexpress.exe\"\n\t\t\t\t\t )]\n  and\n  (\n    (process.pe.original_file_name : \"wmic.exe\" and process.command_line : \"*shadowcopy*\" and \n\t process.command_line : \"*delete*\") or\n    (process.pe.original_file_name : \"vssadmin.exe\" and process.command_line : \"*shadows*\" and \n\t process.command_line : \"*delete*\") or\n    (process.pe.original_file_name : \"bcdedit.exe\" and process.command_line : (\"*bootstatuspolicy*\", \"*recoveryenabled*\")) or\n    (process.pe.original_file_name : \"wbadmin.exe\" and process.command_line : (\"*catalog*\", \"*systemstatebackup*\") and process.command_line : \"*delete*\")\n  )\n",
            "rule": {
                "description": "Identifies the execution of Windows utilities to tamper with system recovery settings. Adversaries may delete or remove built-in operating system data and turn off services designed to aid in the recovery of a corrupted system and prevent recovery.",
                "id": "740ad26d-3e67-47e1-aff1-adb47a697375",
                "name": "Inhibit System Recovery via Signed Binary Proxy",
                "reference": [],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.003",
                                    "name": "CMSTP",
                                    "reference": "https://attack.mitre.org/techniques/T1218/003/"
                                },
                                {
                                    "id": "T1218.004",
                                    "name": "InstallUtil",
                                    "reference": "https://attack.mitre.org/techniques/T1218/004/"
                                },
                                {
                                    "id": "T1218.005",
                                    "name": "Mshta",
                                    "reference": "https://attack.mitre.org/techniques/T1218/005/"
                                },
                                {
                                    "id": "T1218.009",
                                    "name": "Regsvcs/Regasm",
                                    "reference": "https://attack.mitre.org/techniques/T1218/009/"
                                },
                                {
                                    "id": "T1218.010",
                                    "name": "Regsvr32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/010/"
                                },
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                }
                            ]
                        },
                        {
                            "id": "T1216",
                            "name": "Signed Script Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1216/",
                            "subtechnique": null
                        },
                        {
                            "id": "T1220",
                            "name": "XSL Script Processing",
                            "reference": "https://attack.mitre.org/techniques/T1220/",
                            "subtechnique": null
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0040",
                        "name": "Impact",
                        "reference": "https://attack.mitre.org/tactics/TA0040/"
                    },
                    "technique": [
                        {
                            "id": "T1490",
                            "name": "Inhibit System Recovery",
                            "reference": "https://attack.mitre.org/techniques/T1490/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=1m\n   /* Outlook started via DCOM */\n [process where event.action == \"start\" and\n  process.name : \"outlook.exe\" and process. command_line : \"*-Embedding*\" and\n  process.parent.name : \"svchost.exe\"] by process.entity_id\n   /* Suspicious Outlook child processes */\n [process where event.action == \"start\" and\n   process.pe.original_file_name :\n               (\"cscript.exe\",\n                \"wscript.exe\",\n                \"powershell.exe\",\n                \"rundll32.exe\",\n                \"cmd.exe\",\n                \"mshta.exe\",\n                \"msbuild.exe\",\n                \"InstallUtil.exe\",\n                \"Microsoft.Workflow.Compiler.exe\",\n                \"wmic.exe\",\n                \"regsvr32.exe\",\n                \"pwsh.exe\") and not\n   /* Issue #330 */\n   (process.name:\"rundll32.exe\" and\n    _arraysearch(process.args, $arg, $arg : (\"--eoim\", \"--enable-speech-input\")))] by process.parent.entity_id\n",
            "rule": {
                "description": "Identifies the execution of commonly abused utilities to run DLLs or scripts via the Outlook.Application COM Object. This behavior may indicate adversarial activity to evade defenses on the system.",
                "id": "17030515-5ed0-43c8-9602-f97cbebd43c0",
                "name": "Execution via Outlook Application COM Object",
                "reference": [
                    "https://www.darkoperator.com/blog/2017/11/11/windows-defender-exploit-guard-asr-rules-for-office"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                },
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.010",
                                    "name": "Regsvr32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/010/"
                                },
                                {
                                    "id": "T1218.005",
                                    "name": "Mshta",
                                    "reference": "https://attack.mitre.org/techniques/T1218/005/"
                                },
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.name != null and\n     (\n       (process.pe.original_file_name == \"cscript.exe\" and not process.name : \"cscript.exe\") or\n       (process.pe.original_file_name == \"wscript.exe\" and not process.name : \"wscript.exe\") or\n       (process.pe.original_file_name == \"PowerShell.EXE\" and not process.name : \"PowerShell.EXE\") or\n       (process.pe.original_file_name == \"Cmd.Exe\" and not process.name : (\"Cmd.Exe\", \"command.com\")) or\n       (process.pe.original_file_name == \"MSHTA.EXE\" and not process.name : \"MSHTA.EXE\") or\n       (process.pe.original_file_name == \"RUNDLL32.EXE\" and not process.name : \"RUNDLL32.EXE\") or\n       (process.pe.original_file_name == \"REGSVR32.EXE\" and not process.name : \"REGSVR32.EXE\") or\n       (process.pe.original_file_name == \"MSBuild.exe\" and not process.name : \"MSBuild.exe\") or\n       (process.pe.original_file_name == \"InstallUtil.exe\" and not process.name : \"InstallUtil.exe\") or\n       (process.pe.original_file_name == \"RegAsm.exe\" and not process.name : \"RegAsm.exe\") or\n       (process.pe.original_file_name == \"RegSvcs.exe\" and not process.name : \"RegSvcs.exe\") or\n       (process.pe.original_file_name == \"msxsl.exe\" and not process.name : \"msxsl.exe\") or\n       (process.pe.original_file_name == \"Microsoft.Workflow.Compiler.exe\" and\n        not process.name : \"Microsoft.Workflow.Compiler.exe\") or\n       (process.pe.original_file_name == \"msiexec.exe\" and not process.name : \"msiexec.exe\" and\n        not process.executable : \"?:\\\\Windows\\\\Installer\\\\MSI*.tmp\") or\n       (process.pe.original_file_name == \"CMSTP.EXE\" and not process.name : \"CMSTP.EXE\") or\n       (process.pe.original_file_name == \"bitsadmin.exe\" and not process.name : \"bitsadmin.exe\") or\n       (process.pe.original_file_name == \"CertUtil.exe\" and not process.name : \"CertUtil.exe\") or\n       (process.pe.original_file_name == \"wmic.exe\" and not process.name : \"wmic.exe\") or\n       (process.pe.original_file_name == \"schtasks.exe\" and not process.name : \"schtasks.exe\") or\n       (process.pe.original_file_name == \"wuauclt.exe\" and not process.name : \"wuauclt.exe\") or\n       (process.pe.original_file_name == \"Bginfo.exe\" and not process.name : \"Bginfo*.exe\") or\n       (process.pe.original_file_name == \"VsJITDebugger.exe\" and not process.name : \"VsJITDebugger.exe\") or\n       (process.pe.original_file_name == \"xwizard.exe\" and not process.name : \"xwizard.exe\") or\n       (process.pe.original_file_name == \"extexport.exe\" and not process.name : \"extexport.exe\") or \n       (process.pe.original_file_name == \"CertReq.exe\" and not process.name : \"CertReq.exe\")\n     ) and\n /* some third party programs tend to include renamed binaries, still often run from trusted paths */\n not process.executable :\n        (\n          \"?:\\\\Windows\\\\System32\\\\*.exe\",\n          \"?:\\\\Windows\\\\SysWOW64\\\\*.exe\",\n          \"?:\\\\Program Files (x86)\\\\*.exe\",\n          \"?:\\\\Program Files\\\\*.exe\"\n        )\n",
            "rule": {
                "description": "Identifies built-in Windows programs that have been renamed and can be used for execution, downloads, and/or evasion. Attackers may abuse this tactic to evade filename based detection of built-in tools.",
                "id": "b0207677-5041-470b-981d-13ab956cf5b4",
                "name": "Execution via Renamed Signed Binary Proxy",
                "reference": [
                    "https://lolbas-project.github.io"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.Ext.token.integrity_level_name == \"high\" and\n  _arraysearch(process.args, $arg, $arg :\n                    (\"?:\\\\Windows \\\\System32\\\\*.exe\",\n                     \"?:\\\\Windows \\\\SysWOW64\\\\*.exe\",\n                     \"?:\\\\ Windows*\\\\System32\\\\*.exe\",\n                     \"?:\\\\ Windows*\\\\SysWOW64\\\\*.exe\")\n               )\n",
            "rule": {
                "description": "Identifies an attempt to bypass User Account Control (UAC) by masquerading as a Microsoft trusted Windows directory. Attackers may bypass UAC to stealthily execute code with elevated permissions.",
                "id": "adaf95d2-28ce-4880-af16-f3041b624440",
                "name": "UAC Bypass Attempt via Windows Directory Masquerading",
                "reference": [
                    "https://medium.com/tenable-techblog/uac-bypass-by-mocking-trusted-directories-24a96675f6e"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and process.name : \"rundll32.exe\" and\n  /* suspicious extensions and paths */\n  process.command_line :\n          (\"*.jpg,*\",\n           \"*.png,*\",\n           \"*.gif,*\",\n           \"*.bmp,*\",\n           \"*.jpeg,*\",\n           \"*.TIFF,*\",\n           \"*.tmp,*\",\n           \"*.dat,*\",\n           \"*.txt,*\",\n           \"* ?:/*/*\",\n           \"* ..\\\\*\",\n           \"*:\\\\Users\\\\Public\\\\*,*\",\n           \"*:\\\\Users\\\\*\\\\Documents\\\\*,*\",\n           \"*:\\\\Users\\\\*\\\\Pictures\\\\*,*\",\n           \"*:\\\\Users\\\\*\\\\Music\\\\*,*\",\n           \"*:\\\\Windows\\\\Tasks\\\\*,*\",\n           \"*:\\\\Windows\\\\System32\\\\tasks\\\\*,*\",\n           \"*:\\\\Documents and Settings\\\\*,*\") and not\n  process.command_line :\n           (\"*JOBID=*\",\n            \"*davclnt.dll,DavSetCookie*\",\n            \"*PhotoViewer.dll*ImageView_Fu*\",\n            \"*url.dll,FileProtocolHandler*\",\n            \"*zzzzInvokeManagedCustomActionOutOfProc*\",\n            \"*,DeferredDelete*\",\n            \"*:\\\\WINDOWS\\\\system32\\\\spool\\\\*\",\n            \"*:\\\\Program Files (x86)\\\\*\",\n            \"*:\\\\Program Files\\\\*\",\n            /* Issue #282 - FP */\n            \"*cryptext.dll,CryptExtAddPFX*\",\n            \"*dfshim.dll*ShOpenVerbShortcut*\",\n            \"*\\\\Documents\\\\DocuShare\\\\*\")\n",
            "rule": {
                "description": "Identifies unusual instances of RunDLL32 with suspicious keywords or paths in the process command line value. Adversaries may abuse rundll32.exe to proxy execution of malicious code.",
                "id": "cfaf983e-1129-464c-b0aa-270f42e20d3d",
                "name": "RunDLL32 with Unusual Arguments",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  (\n    process.pe.original_file_name : \"vssadmin.exe\" and process.command_line : \"*shadows*\" and\n    process.command_line : \"*delete*\" and not process.name : \"vssadmin.exe\"\n  ) or\n  (\n    process.pe.original_file_name : \"bcdedit.exe\" and\n    process.command_line : (\"*bootstatuspolicy*\", \"*recoveryenabled*\") and not process.name : \"bcdedit.exe\"\n  ) or\n  (\n    process.pe.original_file_name : \"wbadmin.exe\" and process.command_line : (\"*catalog*\", \"*systemstatebackup*\") and\n    process.command_line : \"*delete*\" and not process.name : \"wbadmin.exe\"\n  )\n",
            "rule": {
                "description": "Identifies the execution of renamed Windows utilities to tamper with system recovery settings. Adversaries may delete or remove built-in operating system data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.",
                "id": "153f52e2-2fe5-420b-8691-ddb8562b99d7",
                "name": "Inhibit System Recovery via Renamed Utilities",
                "reference": [],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0040",
                        "name": "Impact",
                        "reference": "https://attack.mitre.org/tactics/TA0040/"
                    },
                    "technique": [
                        {
                            "id": "T1490",
                            "name": "Inhibit System Recovery",
                            "reference": "https://attack.mitre.org/techniques/T1490/",
                            "subtechnique": null
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  (\n   process.name : (\"cscript.exe\", \"wscript.exe\", \"rundll32.exe\", \"mshta.exe\", \"regsvr32.exe\") or\n   process.pe.original_file_name : \n               (\"cscript.exe\", \n                \"wscript.exe\",\n                \"rundll32.exe\",\n                \"mshta.exe\", \n                \"regsvr32.exe\")\n  ) and\n  /* Explorer started via DCOM */\n  process.parent.name : \"explorer.exe\" and process.parent.command_line : \"*/factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b}*\" and\n  not\n     (\n      process.name : \"rundll32.exe\" and\n      process.command_line : (\"rundll32.exe*\\\\Users\\\\*\\\\AppData\\\\Local\\\\Cognitas\\\\CrossLink6\\\\csathl32.dll*\",\n                              /* Issue #340 */\n                              \"*dfshim.dll*ShOpenVerbApplication*\")\n     )\n",
            "rule": {
                "description": "Identifies the execution of commonly abused utilities to run DLLs or scripts via a seperate Windows Explorer trampoline. Explorer can be abused to launch malicious scripts or executables from a trusted parent process.",
                "id": "5e8498bb-8cc0-412f-9017-793d94ab76a5",
                "name": "Execution of Commonly Abused Utilities via Explorer Trampoline",
                "reference": [
                    "https://lolbas-project.github.io/lolbas/Binaries/Explorer/"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                },
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.010",
                                    "name": "Regsvr32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/010/"
                                },
                                {
                                    "id": "T1218.005",
                                    "name": "Mshta",
                                    "reference": "https://attack.mitre.org/techniques/T1218/005/"
                                },
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n  [process where event.action == \"start\" and process.executable : \"?:\\\\Windows\\\\*\" and not \n    process.executable :\n             (\"?:\\\\Windows\\\\SysWOW64\\\\msiexec.exe\",\n              \"?:\\\\Windows\\\\System32\\\\msiexec.exe\",\n              \"?:\\\\Windows\\\\System32\\\\drvinst.exe\",\n              \"?:\\\\Windows\\\\System32\\\\WinSAT.exe\",\n              \"?:\\\\Windows\\\\System32\\\\reg.exe\",\n              \"?:\\\\Windows\\\\regedit.exe\",\n              \"?:\\\\Windows\\\\SysWOW64\\\\Macromed\\\\Flash\\\\FlashUtil*_*.exe\",\n              \"?:\\\\Windows\\\\SysWOW64\\\\reg.exe\",\n              \"?:\\\\Windows\\\\System32\\\\csrss.exe\",\n              \"?:\\\\Windows\\\\SysWOW64\\\\DriverStore\\\\*.exe\",\n              \"?:\\\\Windows\\\\System32\\\\DriverStore\\\\*.exe\",\n              \"?:\\\\Windows\\\\Installer\\\\*.exe\",\n              \"?:\\\\Windows\\\\IMECache\\\\*.exe\",\n              \"?:\\\\Windows\\\\System32\\\\sihost.exe\",\n              \"?:\\\\Windows\\\\System32\\\\Speech\\\\SpeechUX\\\\SpeechUXWiz.exe\",\n              \"?:\\\\Windows\\\\System32\\\\CompPkgSrv.exe\",\n              \"?:\\\\Windows\\\\SysWOW64\\\\prevhost.exe\",\n              \"?:\\\\Windows\\\\System32\\\\conhost.exe\",\n              \"?:\\\\Windows\\\\System32\\\\taskhostw.exe\",\n              /* Issue #291 */\n              \"?:\\\\Windows\\\\System32\\\\svchost.exe\",\n              \"?:\\\\Windows\\\\System32\\\\MRT.exe\",\n              \"?:\\\\Windows\\\\explorer.exe\",\n              \"?:\\\\Windows\\\\Temp\\\\*\",\n              \"?:\\\\Windows\\\\Downloaded Program Files\\\\*.exe\",\n              \"?:\\\\Windows\\\\ccmsetup\\\\*.exe\",\n              \"?:\\\\Windows\\\\CCM\\\\*\",\n              \"?:\\\\Windows\\\\ccmcache\\\\*\",\n              \"?:\\\\Windows\\\\Installer\\\\*\",\n              \"?:\\\\Windows\\\\SysWOW64\\\\config\\\\systemprofile\\\\*.exe\",\n              \"?:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\*.exe\",\n              \"?:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v*\\\\powershell*.exe\",\n              \"?:\\\\Windows\\\\SoftwareDistribution\\\\Download\\\\*.exe\") and\n   not (process.name : \"rundll32.exe\" and process.command_line : (\"*\\\\Windows\\\\Downloaded Program Files\\\\*\", \"*zzzzInvokeManagedCustomActionOutOfProc*\")) and\n   not (process.name : \"powershell.exe\" and process.parent.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\"))\n   ]\n  [registry where registry.data.strings[0] != null and\n    registry.path : (\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\"\n    ) and not\n    _arraysearch(registry.data.strings, $arg, $arg :\n                   (\"grpconv -o\",\n                    \"?:\\\\Windows\\\\System32\\\\StikyNot.exe\",\n                    \"ctfmon.exe /n\",\n                    \"netsh.exe trace postreset\",\n                    \"\\\"?:\\\\Windows\\\\System32\\\\RtkAudUService64.exe*-background\",\n                    \"%WINDIR%\\\\system32\\\\BitLockerWizardElev.exe *Volume{*\",\n                    \"?:\\\\WINDOWS\\\\system32\\\\spool\\\\DRIVERS\\\\x64\\\\*\",\n                    \"?:\\\\Program Files (x86)\\\\*.exe\",\n                    \"?:\\\\Program Files\\\\*.exe\",\n                    \"*\\\\Users\\\\*\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\*\",\n                    /* Issue #291 */\n                    \"*\\\\Windows\\\\Downloaded Program Files\\\\*\",\n                    \"*%ProgramFiles%*\"))]\n",
            "rule": {
                "description": "Identifies trusted Windows processes that rarely modify the Run and RunOnce keys. Run and RunOnce registry keys cause programs to run each time that a user logs on and are often abused by adversaries to maintain persistence on an endpoint.",
                "id": "b2fcbb09-d9bd-4f6c-a08e-247548b4edcd",
                "name": "Registry Run Key Modified by Unusual Process",
                "reference": [
                    "https://docs.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=1m\n  [process where event.action == \"start\" and\n   process.pe.original_file_name == \"RUNDLL32.EXE\" and\n   process.command_line :\n          (\"*advpack*RegisterOCX*\",\n           \"*advpack*#12*\",\n           \"*zipfldr*RouteTheCall*\",\n           \"*pcwutl*LaunchApplication*\",\n           \"*pcwutl*#1*\",\n           \"*url.dll*FileProtocolHandler*file://*\",\n           \"*url.dll*FileProtocolHandler*.exe*\",\n           \"*shell32.dll*ShellExec_RunDLL*\",\n           \"*advpack*LaunchINFSection*\") and\n   /* Issue #265 */\n   not (process.command_line : \"*url.dll*FileProtocolHandler*\" and\n        process.command_line : (\"*http://*\", \"*zoommtg://*\", \"*://*&*&*\"))] by process.entity_id\n  [process where event.action == \"start\" and\n   not (process.executable:(\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\") and\n        process.code_signature.trusted == true)] by process.parent.entity_id\n",
            "rule": {
                "description": "Identifies the execution of a malicious application via rundll32.exe. Adversaries may abuse rundll32.exe to proxy execution of malicious code and bypass application whitelisting configuration.",
                "id": "f60455df-5054-49ff-9ff7-1dc4e37b6ea7",
                "name": "Binary Proxy Execution via Rundll32",
                "reference": [
                    "https://lolbas-project.github.io/lolbas/Libraries/Shell32/",
                    "https://lolbas-project.github.io/lolbas/Libraries/Zipfldr/",
                    "https://lolbas-project.github.io/lolbas/Libraries/Pcwutl/",
                    "https://lolbas-project.github.io/lolbas/Libraries/Advpack/",
                    "https://lolbas-project.github.io/lolbas/Libraries/Ieadvpack/",
                    "https://lolbas-project.github.io/lolbas/Libraries/Url/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n [registry where registry.hive == \"HKEY_USERS\" and registry.data.strings[0] != null and\n   registry.key : \"S-1-5-21-*Classes\\\\ms-settings\\\\shell\\\\open\\\\command\"]\n [process where event.action == \"start\" and process.parent.name : \"ComputerDefaults.exe\" and\n  process.Ext.token.integrity_level_name == \"high\" and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\")]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via ComputerDefaults execution hijack. Attackers bypass UAC to stealthily execute code with elevated permissions.",
                "id": "7c0048d5-356d-4f69-839e-10c1e194958f",
                "name": "UAC Bypass via ComputerDefaults Execution Hijack",
                "reference": [
                    "https://github.com/hfiref0x/UACME"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=5m\n  [file where event.action != \"deletion\" and process.name : \"eqnedt32.exe\" and\n   (file.extension : (\"exe\", \"com\") or (file.Ext.header_data[0] == 77 and file.Ext.header_data[1] == 90))] by file.path\n  [process where event.action == \"start\"] by process.executable\n",
            "rule": {
                "description": "Identifies the execution of a file written or modified by Microsoft Equation Editor, which is frequently targeted by attackers using weaponized Microsoft Office documents. These files are often written or modified during the exploitation of Office applications via known vulnerabilities CVE-2017-1182 or CVE-2018-0798.",
                "id": "8bc4f22c-9bb1-4c76-a7b6-195bee3579db",
                "name": "Execution of File Written or Modified by Microsoft Equation Editor",
                "reference": [
                    "https://www.anomali.com/blog/multiple-chinese-threat-groups-exploiting-cve-2018-0798-equation-editor-vulnerability-since-late-2018",
                    "https://nvd.nist.gov/vuln/detail/CVE-2017-11882",
                    "https://nvd.nist.gov/vuln/detail/CVE-2018-0798"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1203",
                            "name": "Exploitation for Client Execution",
                            "reference": "https://attack.mitre.org/techniques/T1203/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=5m\n  [file where event.action != \"deletion\" and\n   process.name : (\"cscript.exe\", \"wscript.exe\") and\n   not file.path : (\"?:\\\\Program Files (x86)\\\\*.exe\", \"?:\\\\Program Files\\\\*.exe\")] by file.path\n  [process where event.action == \"start\" and\n   not process.parent.executable : (\"?:\\\\Windows\\\\System32\\\\drvinst.exe\")] by process.executable\n",
            "rule": {
                "description": "Identifies the execution of a file written or modified by Microsoft Windows Script Host processes (cscript or wscript).",
                "id": "49e47c2a-307f-4591-939a-dfdae6e5156c",
                "name": "Execution of a File Written by Windows Script Host",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  (process.name : \"bitsadmin.exe\" or process.pe.original_file_name : \"bitsadmin.exe\") and\n  _arraysearch(process.args, $arg, $arg : (\"*download*\", \"*transfer*\", \"*create*\", \"*addfile*\", \"*SetNotifyCmdLine*\")) and\n  (process.parent.name : (\n      \"winword.exe\",\n      \"excel.exe\",\n      \"outlook.exe\",\n      \"powerpnt.exe\",\n      \"eqnedt32.exe\",\n      \"fltldr.exe\",\n      \"mspub.exe\",\n      \"msaccess.exe\",\n      \"acrord32.exe\",\n      \"rdrcef.exe\",\n      \"foxitphantomPDF.exe\",\n      \"foxitreader.exe\",\n      \"firefox.exe\",\n      \"chrome.exe\",\n      \"iexplore.exe\",\n      \"opera.exe\",\n      \"plugin-container.exe\",\n      \"safari.exe\",\n      \"microsoftedge.exe\",\n      \"w3wp.exe\",\n      \"httpd.exe\",\n      \"nginx.exe\",\n      \"php.exe\",\n      \"php-cgi.exe\",\n      \"tomcat.exe\",\n      \"wscript.exe\",\n      \"cscript.exe\",\n      \"powershell.exe\",\n      \"pwsh.exe\",\n      \"cmd.exe\"\n      ) or\n  descendant of [process where event.action == \"start\" and\n    process.parent.name : (\n      \"winword.exe\",\n      \"excel.exe\",\n      \"outlook.exe\",\n      \"powerpnt.exe\",\n      \"eqnedt32.exe\",\n      \"fltldr.exe\",\n      \"mspub.exe\",\n      \"msaccess.exe\",\n      \"acrord32.exe\",\n      \"rdrcef.exe\",\n      \"foxitphantomPDF.exe\",\n      \"foxitreader.exe\",\n      \"firefox.exe\",\n      \"chrome.exe\",\n      \"iexplore.exe\",\n      \"opera.exe\",\n      \"plugin-container.exe\",\n      \"safari.exe\",\n      \"microsoftedge.exe\",\n      \"w3wp.exe\",\n      \"httpd.exe\",\n      \"nginx.exe\",\n      \"php.exe\",\n      \"php-cgi.exe\",\n      \"tomcat.exe\",\n      \"wscript.exe\",\n      \"cscript.exe\",\n      \"powershell.exe\",\n      \"pwsh.exe\",\n      \"cmd.exe\"\n    )])\n",
            "rule": {
                "description": "Identifies downloads, transfers, or job creations using Windows Background Intelligent Transfer Service (BITS) Admin Tool. This tactic may be indicative of malicious activity where malware is downloading second stage payloads using obscure methods.",
                "id": "676ac66c-4899-498f-ae21-ed5620af5477",
                "name": "Suspicious Bitsadmin Activity",
                "reference": [
                    "https://www.elastic.co/blog/hunting-for-persistence-using-elastic-security-part-2"
                ],
                "severity": "low",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1197",
                            "name": "BITS Jobs",
                            "reference": "https://attack.mitre.org/techniques/T1197/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 2,
            "query": "sequence with maxspan=60s\n [file where event.action != \"deletion\" and file.extension : \"msc\" and not user.name : \"SYSTEM\"]\n [process where event.action == \"start\" and\n  process.name : \"mmc.exe\" and process.command_line : \"*.msc *.msc*\"]\n [process where event.action == \"start\" and\n  process.parent.name : \"mmc.exe\" and process.Ext.token.integrity_level_name == \"high\" and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\")]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) by executing a malicious Microsoft Management Console (MMC) snap-in. Attackers bypass UAC to stealthily execute code with elevated permissions.",
                "id": "ccdf56a8-697b-497c-ab90-3aa01bfc5f9f",
                "name": "UAC Bypass via Malicious MMC Snap-In Execution",
                "reference": [
                    "https://github.com/hfiref0x/UACME/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and process.parent.name : \"EQNEDT32.EXE\" and\n  not process.executable : (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\", \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\")\n",
            "rule": {
                "description": "Identifies suspicious child processes of the Microsoft Equation Editor process, which is frequently targeted by attackers using weaponized Microsoft Office documents. These child processes are often launched during exploitation of Office applications via known vulnerabilities CVE-2017-1182 or CVE-2018-0798.",
                "id": "60eb5960-b26e-494a-8cf2-35ab5939f6c1",
                "name": "Microsoft Equation Editor Child Process",
                "reference": [
                    "https://www.anomali.com/blog/multiple-chinese-threat-groups-exploiting-cve-2018-0798-equation-editor-vulnerability-since-late-2018",
                    "https://nvd.nist.gov/vuln/detail/CVE-2017-11882",
                    "https://nvd.nist.gov/vuln/detail/CVE-2018-0798"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1203",
                            "name": "Exploitation for Client Execution",
                            "reference": "https://attack.mitre.org/techniques/T1203/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 2,
            "query": "sequence with maxspan=60s\n  [process where event.action == \"start\" and process.name : \"cmd.exe\" and\n   process.command_line :\n         (\"*find*.*.lnk*>*&*\",\n          \"*.lnk*find*>*&*\",\n          \"*dir*/s*/b*.lnk*\",\n          \"*dir*.lnk*/s*/b*\",\n          \"*for*/f*in*.lnk*\",\n          \"*LoadFromFile*.lnk*>*&*\",\n          \"*.lnk*do type*\",\n          \"*/s*/d*type*.lnk*\",\n          \"*.doc.lnk*\",\n          \"*.pdf.lnk*\")\n   ] by process.entity_id\n  [file where event.action != \"deletion\" and process.name : \"cmd.exe\"] by process.entity_id\n  [process where event.action == \"start\" and\n   not process.executable : \n           (\"?:\\\\Windows\\\\system32\\\\attrib.exe\", \n            \"?:\\\\Windows\\\\SysWOW64\\\\attrib.exe\", \n            \"?:\\\\Windows\\\\system32\\\\find.exe\", \n            \"?:\\\\Windows\\\\SysWOW64\\\\find.exe\",\n            \"?:\\\\Windows\\\\system32\\\\findstr.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\findstr.exe\",\n            \"?:\\\\Windows\\\\system32\\\\conhost.exe\", \n            \"?:\\\\Windows\\\\SysWOW64\\\\conhost.exe\") and\n   not (process.name : \"cmd.exe\" and\n          process.command_line :\n                 (\"*find*.*.lnk*>*\",\n                  \"*.lnk*find*>*\",\n                  \"*dir*/s*/b*.lnk*\",\n                  \"*dir*.lnk*/s*/b*\",\n                  \"*for*/f*in*.lnk*\",\n                  \"*LoadFromFile*.lnk*\",\n                  \"*.lnk*do type*\",\n                  \"*/s*/d*type*.lnk*\",\n                  \"*.doc.lnk*\",\n                  \"*.pdf.lnk*\"))\n   ] by process.parent.entity_id\n",
            "rule": {
                "description": "Identifies the execution of a script or program extracted from within a Windows shortcut file (lnk) . Adversaries may embed malicious scripts or files in a shortcut file before delivering it to their target in order to trick them into executing the payload.",
                "id": "8076640d-ec66-4d24-a252-ee2f054e00a1",
                "name": "Windows Shortcut File Embedded Object Execution",
                "reference": [
                    "https://docs.google.com/presentation/d/13SsBd0wI0PpyH5C8WlnE_DsJjy1KxAjZ5Dmke9FHfRE/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                },
                                {
                                    "id": "T1566.002",
                                    "name": "Spearphishing Link",
                                    "reference": "https://attack.mitre.org/techniques/T1566/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.003",
                                    "name": "Windows Command Shell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/003/"
                                }
                            ]
                        },
                        {
                            "id": "T1204",
                            "name": "User Execution",
                            "reference": "https://attack.mitre.org/techniques/T1204/",
                            "subtechnique": [
                                {
                                    "id": "T1204.001",
                                    "name": "Malicious Link",
                                    "reference": "https://attack.mitre.org/techniques/T1204/001/"
                                },
                                {
                                    "id": "T1204.002",
                                    "name": "Malicious File",
                                    "reference": "https://attack.mitre.org/techniques/T1204/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  process.parent.name : (\"excel.exe\", \"powerpnt.exe\", \"winword.exe\") and\n  (process.pe.original_file_name == \"Cmd.Exe\" or process.name : \"cmd.exe\") and\n  process.command_line :\n              (\"*^*^*^*^*^*\",\n              \"*set *set *set *\",\n              \"*set *for *call *\",\n              \"*set *for *cmd *\",\n              \"*$*$*$*$*\",\n              \"*comspec*\",\n              \"*powershell*\",\n              \"*wscript*\",\n              \"*cscript*\",\n              \"*mshta*\", \n              \"*certutil*\", \n              \"*bitsadmin*\", \n              \"*/transfer*\",\n              \"*-transfer*\",\n              \"*urlcache*\", \n              \"*-decode*\", \n              \"*addfile*\",\n              \"*msbuild*\",\n              \"*msiexec*\",\n              \"*rundll32*\",\n              \"*regsvr32*\", \n              \"*ping * -n *&*\",\n              \"*http://*\",\n              \"*%%*%%*%%*\") and\n  not process.command_line : (\"*:\\\\Program Files\\\\Tableau\\\\*--server*http://tableau*\", \"*:\\\\Program Files (x86)\\\\Tableau\\\\*--server*http://tableau*\") \n",
            "rule": {
                "description": "Identifies a Microsoft Office application (Word, PowerPoint, Excel) starting a Windows command prompt using suspicious commands.",
                "id": "2a396a3c-b343-42a9-b74b-c5b9925b6ee2",
                "name": "Windows Command Shell Spawned via Microsoft Office",
                "reference": [
                    "https://github.com/danielbohannon/Invoke-DOSfuscation"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.003",
                                    "name": "Windows Command Shell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/003/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n [registry where registry.hive == \"HKEY_USERS\" and registry.data.strings[0] != null and\n   registry.key :\n          (\"S-1-5-21-*Classes\\\\Launcher.SystemSettings\\\\shell\\\\open\\\\command\",\n           \"S-1-5-21-*Classes\\\\exefile\\\\shell\\\\open\\\\command\")]\n [process where event.action == \"start\" and \n  process.parent.name : (\"changepk.exe\", \"slui.exe\") and\n  process.Ext.token.integrity_level_name == \"high\" and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\", \n\t      \"?:\\\\Windows\\\\System32\\\\changepk.exe\")]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via Windows activation changepk.exe execution hijack. Attackers bypass UAC to stealthily execute code with elevated permissions.",
                "id": "71ad1420-ed83-46d0-835b-63d4b2008427",
                "name": "UAC Bypass via Windows Activation Execution Hijack",
                "reference": [
                    "https://github.com/hfiref0x/UACME",
                    "https://medium.com/@mattharr0ey/privilege-escalation-uac-bypass-in-changepk-c40b92818d1b"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n  [process where event.action == \"start\" and not\n   (process.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\") and\n    process.code_signature.trusted == true) and not \n    process.executable : (\"?:\\\\Windows\\\\SysWOW64\\\\msiexec.exe\", \"?:\\\\Windows\\\\system32\\\\msiexec.exe\") and not\n    user.id : \"S-1-5-18\" and \n    /* Issue #324 */\n    not process.executable : (\"?:\\\\Windows\\\\SysWOW64\\\\Macromed\\\\Flash\\\\*.exe\",\n                             \"?:\\\\Windows\\\\Downloaded Program Files\\\\*.exe\") and\n    not process.parent.executable : (\"?:\\\\Windows\\\\Downloaded Program Files\\\\*.exe\",\n                                 \"?:\\\\Windows\\\\SysWOW64\\\\msiexec.exe\",\n                                 \"?:\\\\Windows\\\\system32\\\\msiexec.exe\") and \n    not (process.code_signature.subject_name : \"*Norton*\" and process.code_signature.trusted == true) and \n    not (process.executable : \"?:\\\\Windows\\\\system32\\\\spool\\\\DRIVERS\\\\x64\\\\3\\\\\" and process.code_signature.trusted == true)\n   ]\n  [registry where registry.data.strings[0] != null and\n    registry.path : (\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\") and\n    _arraysearch(registry.data.strings, $arg, $arg :\n            (\"*rundll32*\",\n             \"*regsvr32*\",\n             \"*mshta*\",\n             \"*msbuild*\",\n             \"*RegAsm*\",\n             \"*RegSvcs*\",\n             \"*InstallUtil*\",\n             \"*cscript*\",\n             \"*wscript*\",\n             \"*.js?\",\n             \"*.js\",\n             \"*.vbs?\",\n             \"*.vbs\",\n             \"*.vbe?\",\n             \"*.vbe\",\n             \"*.bat?\",\n             \"*.bat\",\n             \"*.url\",\n             \"*.url?\",\n             \"*.lnk\",\n             \"*.lnk?\",\n             \"*msxsl*\",\n             \"*cmstp*\",\n             \"*cerutil*\",\n             \"*bitsadmin*\",\n             \"*msiexec*\",\n             \"*wmic*\",\n             \"*powershell*\",\n             \"*cmd.exe *\",\n             \"*svchost*\",\n             \"*lsass*\",\n             \"*csrss*\",\n             \"*winlogon*\",\n             \"*Microsoft.Workflow.Compiler.exe*\",\n             \"*VBScript.Encode*\",\n             \"*http://*\",\n             \"*WScript.Shell*\",\n             \"*VBScript.Encode*\",\n             \"*:\\\\Users\\\\Public\\\\*\",\n             \"*:\\\\Users\\\\*\\\\Documents\\\\*\",\n             \"*:\\\\Documents and Settings\\\\*\",\n             \"*:\\\\Users\\\\*\\\\Pictures\\\\*\",\n             \"*:\\\\Users\\\\*\\\\Music\\\\*\",\n             \"*:\\\\Users\\\\*\\\\Pictures\\\\*\",\n             \"*\\\\Windows\\\\Start Menu\\\\Programs\\\\*\",\n             \"?:\\\\Windows\\\\*\",\n             \"??:\\\\Windows\\\\*\")) and not\n    _arraysearch(registry.data.strings, $arg, $arg :\n                   (\"*rundll32.exe*advpack.dll,DelNodeRunDLL32*\",\n                    \"*LogiLDA.dll,LogiFetch*\",\n                    \"*\\\\Users\\\\*\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\*\",\n                    \"*%ProgramFiles%*\",\n                    \"*:\\\\Program Files\\\\*\",\n                    \"*:\\\\Program Files (x86)\\\\*\",\n                    \"*:\\\\Windows\\\\SystemApps\\\\*\",\n                    \"*:\\\\Windows\\\\System32\\\\DriverStore\\\\*\",\n                    \"*:\\\\WINDOWS\\\\Speech\\\\*\",\n                    \"*:\\\\WINDOWS\\\\System32\\\\RtkAudUService*\",\n                    \"*:\\\\WINDOWS\\\\system32\\\\SecurityHealthSystray.exe\",\n                    \"*restartSAPinst.vbs*\",\n                    /* Issue #324 */\n                    \"*\\\\Windows\\\\Downloaded Program Files\\\\*\",\n                    \"*\\\\Windows\\\\SysWOW64\\\\Macromed\\\\*\"))]\n",
            "rule": {
                "description": "Identifies when suspicious values are written to Run and RunOnce registry keys via signed binaries. Run and RunOnce registry keys cause programs to run each time that a user logs on and are often abused by adversaries to maintain persistence on an endpoint.",
                "id": "727db78e-e1dd-4bc0-89b0-885cd99e069e",
                "name": "Suspicious String Value Written to Registry Run Key",
                "reference": [
                    "https://docs.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by user.id with maxspan=1m\n  [file where event.action != \"deletion\" and\n    (file.extension : (\"exe\", \"com\") or (file.Ext.header_data[0] == 77 and file.Ext.header_data[1] == 90)) and\n    process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\") and\n    not file.path :\n            (\n              \"?:\\\\Users\\\\*\\\\Desktop\\\\*\",\n              \"?:\\\\Users\\\\*\\\\Downloads\\\\*\",\n              \"?:\\\\Users\\\\*\\\\Documents\\\\*\",\n              \"?:\\\\Users\\\\*\\\\AppData\\\\Local\\\\Temp\\\\*-*-*-*\\\\*\",\n              \"?:\\\\Program Files (x86)\\\\*\",\n              \"?:\\\\Program Files\\\\*\"\n            )\n    ] by file.path\n  [process where event.action == \"start\" and\n    process.parent.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\") and\n    not process.code_signature.trusted == true] by process.executable\n",
            "rule": {
                "description": "Identifies the execution of an unsigned file written or modified by Microsoft Office processes.",
                "id": "bb23a662-2d75-4714-837d-4ec9c2e772a5",
                "name": "Untrusted File Execution via Microsoft Office",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n [library where dll.name : \"wow64log.dll\" and\n  not (dll.code_signature.subject_name : \"Microsoft *\" and dll.code_signature.trusted == true)\n ] by process.entity_id\n [process where event.action == \"start\" and\n  process.Ext.token.integrity_level_name : (\"high\", \"system\") and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\System32\\\\wermgr.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\wermgr.exe\",\n            \"?:\\\\Windows\\\\System32\\\\conhost.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\conhost.exe\")] by process.parent.entity_id\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via WoW64 logger DLL side-loading. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.",
                "id": "28a39a43-e850-4941-8605-ffa23dcfd25a",
                "name": "UAC Bypass Attempt via WOW64 Logger DLL Side-Loading",
                "reference": [
                    "https://github.com/hfiref0x/UACME",
                    "http://waleedassar.blogspot.com/2013/01/wow64logdll.html"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.002",
                                    "name": "DLL Side-Loading",
                                    "reference": "https://attack.mitre.org/techniques/T1574/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 2,
            "query": "sequence with maxspan=1m\n  [registry where registry.data.strings[0] != null and\n   registry.hive == \"HKEY_USERS\" and\n   registry.key : \"S-1-5-21*_Classes\\\\Folder\\\\Shell\\\\Open\\\\Command\"]\n  [process where event.action == \"start\" and process.pe.original_file_name : \"sdclt.exe\"]\n  [process where event.action == \"start\" and\n   process.Ext.token.integrity_level_name == \"high\" and\n   process.parent.name : \"control.exe\" and process.parent.command_line : \"*Microsoft.BackupAndRestoreCenter*\"]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via hijacking the default handler of the Backup and Restore control panel. Attackers bypass UAC to stealthily execute code with elevated permissions.",
                "id": "0545f127-b1ae-478a-a68a-84f477f765e2",
                "name": "UAC Bypass via Control Panel Execution Hijack",
                "reference": [
                    "https://github.com/hfiref0x/UACME"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id with maxspan=5m\n [process where event.action == \"start\" and\n  /* Issue # 312 */\n  not process.executable : \"?:\\\\Windows\\\\explorer.exe\" and \n  not (process.name : \"dllhost.exe\" and process.parent.name : \"svchost.exe\")\n ]\n [registry where\n  registry.path : (\n     \"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\User Shell Folders\\\\Common Startup\",\n     \"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders\\\\Common Startup\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\User Shell Folders\\\\Startup\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders\\\\Startup\"\n     ) and\n  registry.data.strings[0] != null and\n   // Normal Startup Folder Paths\n   not _arraysearch(registry.data.strings, $arg, $arg :  (\n           \"?:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\",\n           \"%ProgramData%\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\",\n           \"%USERPROFILE%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\",\n           \"?:\\\\Users\\\\*\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\"\n           ))]\n",
            "rule": {
                "description": "Identifies suspicious startup shell folder modifications. An adversary may attempt to change the default startup directory in order to bypass detections that monitor for suspicious file creation events in the default Windows Startup folder.",
                "id": "377aad38-24e0-4dd7-93c2-bd231cb749e3",
                "name": "Unusual Startup Shell Folder Modification",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1112",
                            "name": "Modify Registry",
                            "reference": "https://attack.mitre.org/techniques/T1112/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n [process where event.action == \"start\" and process.name : (\"EQNEDT32.EXE\", \"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSPUB.EXE\", \"MSACCESS.EXE\")]\n [file where event.action != \"deletion\" and\n  file.path : (\"?:\\\\Users\\\\*\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\",\n               \"?:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\*\") and\n  process.name : (\"EQNEDT32.EXE\", \"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSPUB.EXE\", \"MSACCESS.EXE\")]\n",
            "rule": {
                "description": "Identifies files written to or modified in the startup folder by a Microsoft Office process. Adversaries may use this technique to maintain persistence and avoid spawning suspicious child processes.",
                "id": "2b8ea430-897d-486c-85a8-add9d7072ff3",
                "name": "Microsoft Office Process Setting Persistence via Startup",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id with maxspan=1m\n  [process where event.action == \"start\" and process.name : \"rundll32.exe\" and process.args_count == 1]\n  [network where event.action == \"connection_attempted\" and process.name : \"rundll32.exe\"]\n",
            "rule": {
                "description": "Identifies unusual instances of rundll32.exe making outbound network connections. This may be indicative of adversarial command and control activity.",
                "id": "2e708541-c6e8-4ded-923f-78a6c160987e",
                "name": "Unusual Network Connection via RunDLL32",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1055",
                            "name": "Process Injection",
                            "reference": "https://attack.mitre.org/techniques/T1055/",
                            "subtechnique": null
                        },
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n [file where event.action : \"rename\" and\n  process.name : (\"dllhost.exe\", \"wusa.exe\") and\n  file.path : (\"?:\\\\*\\\\dccw.exe.*\\\\*.dll\", \"?:\\\\*\\\\dccw.exe.*\\\\*.dll\")]\n [process where event.action == \"start\" and\n  process.parent.name : \"dccw.exe\" and process.Ext.token.integrity_level_name == \"high\" and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\System32\\\\cttune.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\cttune.exe\")]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via Display Color Calibration DLL search order hijacking. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.",
                "id": "093bd845-b59f-4868-a7dd-62d48b737bf6",
                "name": "UAC Bypass Attempt via DCCW DLL Search Order Hijacking",
                "reference": [
                    "https://github.com/hfiref0x/UACME",
                    "https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-redirection"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.001",
                                    "name": "DLL Search Order Hijacking",
                                    "reference": "https://attack.mitre.org/techniques/T1574/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1129",
                            "name": "Shared Modules",
                            "reference": "https://attack.mitre.org/techniques/T1129/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.parent.name : \"eventvwr.exe\" and\n process.Ext.token.integrity_level_name == \"high\" and\n not process.executable :\n           (\"?:\\\\Windows\\\\SysWOW64\\\\mmc.exe\",\n            \"?:\\\\Windows\\\\System32\\\\mmc.exe\",\n            \"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\System32\\\\wermgr.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\wermgr.exe\")\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via eventvwr.exe. Attackers bypass UAC to stealthily execute code with elevated permissions.",
                "id": "ab29a79a-b3c2-4ae4-9670-70dd0ea68a4a",
                "name": "UAC Bypass via Event Viewer",
                "reference": [
                    "https://github.com/hfiref0x/UACME"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and process.name : \"regsvr32.exe\" and\n process.command_line :\n          (\"*.jpg*\",\n           \"*.png*\",\n           \"*.gif*\",\n           \"*.bmp*\",\n           \"*.jpeg*\",\n           \"*.TIFF*\",\n           \"*.tmp*\",\n           \"*.dat*\",\n           \"*.pdf*\",\n           \"*.doc*\",\n           \"*.xls*\",\n           \"*.ppt*\",\n           \"*.txt*\",\n           \"* ?:/*/*\",\n           \"* ..\\\\*\",\n           \"*:\\\\Users\\\\Public\\\\*\",\n           \"*:\\\\Users\\\\*\\\\Documents\\\\*\",\n           \"*:\\\\Users\\\\*\\\\Pictures\\\\*\",\n           \"*:\\\\Users\\\\*\\\\Music\\\\*\",\n           \"*:\\\\Users\\\\*\\\\Pictures\\\\*\",\n           \"*:\\\\Windows\\\\Tasks\\\\*\",\n           \"*:\\\\Windows\\\\System32\\\\tasks\\\\*\") and not\n process.command_line : (\"?:\\\\Program Files (x86)\\\\*\", \"?:\\\\Program Files\\\\*\")\n",
            "rule": {
                "description": "Identifies unusual instances of Regsvr32 with suspicious keywords or paths in the process command line value. Adversaries may abuse regsvr32.exe to proxy execution of malicious code.",
                "id": "5db08297-bf72-49f4-b426-f405c2b01326",
                "name": "Regsvr32 with Unusual Arguments",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.010",
                                    "name": "Regsvr32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/010/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n [process where event.action == \"start\" and not\n    process.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\") and not\n    process.parent.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\") and not\n    (process.executable : \"?:\\\\Windows\\\\*.exe\" and process.code_signature.trusted == true) and not\n    user.id : \"S-1-5-18\"]\n [file where event.action != \"deletion\" and\n  file.name != null and\n  file.path : (\"?:\\\\Users\\\\*\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\",\n               \"?:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\*\") and\n   file.extension : (\"js\", \"vbs\")]\n",
            "rule": {
                "description": "Identifies suspicious Windows script file extensions written to the startup folder. Adversaries may use this technique to maintain persistence.",
                "id": "dec8781c-ef73-4037-9684-ef28c0322fa4",
                "name": "Script File Written to Startup Folder",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n (process.pe.original_file_name == \"PowerShell.EXE\" or process.name : (\"powershell.exe\", \"pwsh.exe\")) and\n (\n  process.parent.name : (\"excel.exe\", \"powerpnt.exe\", \"winword.exe\") or\n  (descendant of [process where event.action == \"start\" and process.name : (\"excel.exe\", \"powerpnt.exe\", \"winword.exe\")] and\n   /* Issue #263 */\n   not process.parent.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\"))\n  ) and\n  process.command_line :\n              (\"*^*^*^*^*^*^*^*^*^*\",\n              \"*''*''*''*\",\n              \"*`*`*`*`*\",\n              \"*{*{*{*{*{*{*{*{*{*{*{*{*{*{*{*{*{*{*{*\",\n              \"*+*+*+*+*+*\",\n              \"*$*$*$*$*\",\n              \"*[char[]](*)*-join\",\n              \"*Base64String*\",\n              \"*[*Convert]*\",\n              \"*.Text.Encoding*\",\n              \"*.Compression.*\",\n              \"*.replace(*\",\n              \"*MemoryStream*\",\n              \"*WriteAllBytes*\",\n              \"* -en* *\",\n              \"* -ec *\",\n              \"* -e *\",\n              \"* -ex* *\",\n              \"* -ep *\",\n              \"* /e *\",\n              \"* /en* *\",\n              \"* /ec *\",\n              \"* /ex* *\",\n              \"* /ep *\",\n              \"*WebClient*\",\n              \"*DownloadFile*\",\n              \"*DownloadString*\",\n              \"*BitsTransfer*\",\n              \"*Invoke-Exp*\",\n              \"*invoke-web*\",\n              \"*iex*\",\n              \"*iwr*\",\n              \"*Reflection.Assembly*\",\n              \"*Assembly.GetType*\",\n              \"*.Sockets.*\") and\n  /* Issue #263 */\n  not process.parent.executable :\n                 (\"?:\\\\ProgramData\\\\CentraStage\\\\AEMAgent\\\\AEMAgent.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\svchost.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\CompatTelRunner.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\taskeng.exe\")\n",
            "rule": {
                "description": "Identifies a Microsoft Office application (Word, PowerPoint, Excel) starting Windows PowerShell with a suspicious command line.",
                "id": "93ef8a09-0f8d-4aa1-b0fb-47d5d5b40cf2",
                "name": "PowerShell Obfuscation Spawned via Microsoft Office",
                "reference": [
                    "https://github.com/danielbohannon/Invoke-Obfuscation"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  process.pe.original_file_name : \"schtasks.exe\" and\n  _arraysearch(process.args, $arg, $arg : (\"/create\", \"-create\")) and\n  _arraysearch(process.args, $arg, $arg : (\"/xml\", \"-xml\")) and not process.command_line:\"*.xml*\"\n",
            "rule": {
                "description": "Identifies the creation of a scheduled task using a Extensible Markup Language (XML) file that does not have a .xml file extension. This behavior is consistent with an adversary attempting to establish persistence in a stealthy manner to evade detection.",
                "id": "1efc0496-106b-4c09-b99b-91cdd17ba7b3",
                "name": "Suspicious Scheduled Task Creation via Masqueraded XML File",
                "reference": [
                    "https://docs.microsoft.com/en-us/windows/win32/taskschd/daily-trigger-example--xml-"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1053",
                            "name": "Scheduled Task/Job",
                            "reference": "https://attack.mitre.org/techniques/T1053/",
                            "subtechnique": [
                                {
                                    "id": "T1053.005",
                                    "name": "Scheduled Task",
                                    "reference": "https://attack.mitre.org/techniques/T1053/005/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1036",
                            "name": "Masquerading",
                            "reference": "https://attack.mitre.org/techniques/T1036/",
                            "subtechnique": [
                                {
                                    "id": "T1036.005",
                                    "name": "Match Legitimate Name or Location",
                                    "reference": "https://attack.mitre.org/techniques/T1036/005/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  process.parent.name : (\"excel.exe\", \"powerpnt.exe\", \"winword.exe\") and\n  (\n   (process.pe.original_file_name :\n            (\n\t      \"rundll32.exe\", \n\t      \"regsvr32.exe\", \n\t      \"bitsadmin.exe\",\n\t      \"certutil.exe\", \n\t      \"installutil.exe\", \n\t      \"schtasks.exe\", \n\t      \"wmic.exe\", \n\t      \"cscript.exe\", \n\t      \"explorer.exe\", \n\t      \"cmstp.exe\", \n\t      \"Microsoft.Workflow.Compiler.exe\", \n\t      \"regasm.exe\", \n\t      \"regsvcs.exe\", \n\t      \"mshta.exe\", \n\t      \"msxsl.exe\", \n\t      \"ieexec.exe\", \n\t      \"sc.exe\", \n\t      \"hh.exe\",\n\t      \"javaw.exe\",\n\t      \"pcalua.exe\",\n\t      \"curl.exe\"\n\t     ) and\n   not _arraysearch(process.args, $arg, $arg : (\"-Embedding\", \"-hashfile\")) and\n   /* FP related to printing */\n   not (process.name : \"rundll32.exe\" and process.command_line : \"*\\\\system32\\\\spool\\\\*\")\n   ) or\n   (process.pe.original_file_name : \"wscript.exe\" and process.command_line : (\"*:\\\\ProgramData\\\\*\", \"*:\\\\Users\\\\Public\\\\*\", \"*\\\\AppData\\\\*\")) or\n   (process.pe.original_file_name : \"msiexec.exe\" and _arraysearch(process.args, $arg, $arg : \"http*\"))\n   )\n",
            "rule": {
                "description": "Identifies suspicious child processes of frequently targeted Microsoft Office applications (Word, PowerPoint, Excel). These child processes are often launched during exploitation of Office applications or from documents with malicious macros.",
                "id": "c34a9dca-66cf-4283-944d-1800b28ae690",
                "name": "Suspicious Microsoft Office Child Process",
                "reference": [
                    "https://lolbas-project.github.io/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.parent.name : \"dllhost.exe\" and\n process.Ext.token.integrity_level_name == \"high\" and\n process.parent.command_line : (\"*3E5FC7F9-9A51-4367-9063-A120244FBEC7*\", \"*D2E7041B-2927-42FB-8E9F-7CE93B6DC937*\") and\n not process.executable :\n             (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n              \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\",\n              \"?:\\\\Windows\\\\System32\\\\wermgr.exe\",\n              \"?:\\\\Windows\\\\SysWOW64\\\\wermgr.exe\")\n",
            "rule": {
                "description": "Identifies User Account Control (UAC) bypass attempts via the ICMLuaUtil elevated COM interface. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.",
                "id": "13fab475-06e4-4ac9-87fc-2105c7441244",
                "name": "UAC Bypass via ICMLuaUtil Elevated COM Interface",
                "reference": [
                    "https://github.com/hfiref0x/UACME"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n [process where event.action == \"start\" and not\n   (process.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\") and\n    process.code_signature.trusted == true) and not\n    process.executable : (\"?:\\\\Windows\\\\SysWOW64\\\\msiexec.exe\", \"?:\\\\Windows\\\\system32\\\\msiexec.exe\") and not\n    user.id : \"S-1-5-18\"]\n [file where event.action != \"deletion\" and\n  file.name != null and\n  file.path : (\"?:\\\\Users\\\\*\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\",\n               \"?:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\*\") and\n  (\n   /* file extensions rarely written to Startup folder by legit installers */\n   file.extension : (\"exe\", \"com\", \"scr\", \"dll\", \"hta\", \"bat\", \"ps1\", \"cmd\", \"url\", \"wsh\", \"wsf\", \"vbe\", \"jse\", \"sick\", \"png\", \"jpg\") or\n\n   /* suspicious file names */\n   length(file.name) <= 6 or\n   file.name :\n        (\"*Microsoft*\",\n         \"*fuck*\",\n         \"*:*\",\n         \"*.*.\",\n         \"*update*\",\n         \"*windows*\",\n         \"*setup*\",\n         \"*googl*\",\n         \"*adobe*\",\n         \"*chrome*\")\n   )\n  ]\n",
            "rule": {
                "description": "Identifies suspicious file extensions or names written to the startup folder. Adversaries may use this technique to maintain persistence.",
                "id": "30a90136-7831-41c3-a2aa-1a303c1186ac",
                "name": "Unusual File Written or Modified in Startup Folder",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1036",
                            "name": "Masquerading",
                            "reference": "https://attack.mitre.org/techniques/T1036/",
                            "subtechnique": [
                                {
                                    "id": "T1036.005",
                                    "name": "Match Legitimate Name or Location",
                                    "reference": "https://attack.mitre.org/techniques/T1036/005/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n  [process where event.action == \"start\"]\n  [file where event.action != \"deletion\" and\n    (file.extension: \"lnk\" or\n    // Match Windows Shortcut (LNK) files by header (4C 00 00 00)\n    file.Ext.header_data[0] == 76 and\n    file.Ext.header_data[1] == 0 and\n    file.Ext.header_data[2] == 0 and\n    file.Ext.header_data[3] == 0) and\n    // LNK files larger than 200,000 bytes\n    file.size > 200000]\n",
            "rule": {
                "description": "Identifies when an unusually large Windows Shortcut (LNK) file is created or modified. Adversaries may embed malicious scripts or files in a shortcut file before delivering it to their target and tricking them into executing the payload. Adversaries also leverage malicious shortcut files to maintain persistence on an endpoint and ensure that their malicious code is executed when a routine event occurs such as when a user logs in to Windows.",
                "id": "bc8949e6-98e0-4b50-96d4-88fdbb29f0d4",
                "name": "Suspicious Windows Shortcut File Creation or Modification",
                "reference": [
                    "https://docs.google.com/presentation/d/13SsBd0wI0PpyH5C8WlnE_DsJjy1KxAjZ5Dmke9FHfRE/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                },
                                {
                                    "id": "T1566.002",
                                    "name": "Spearphishing Link",
                                    "reference": "https://attack.mitre.org/techniques/T1566/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1204",
                            "name": "User Execution",
                            "reference": "https://attack.mitre.org/techniques/T1204/",
                            "subtechnique": [
                                {
                                    "id": "T1204.001",
                                    "name": "Malicious Link",
                                    "reference": "https://attack.mitre.org/techniques/T1204/001/"
                                },
                                {
                                    "id": "T1204.002",
                                    "name": "Malicious File",
                                    "reference": "https://attack.mitre.org/techniques/T1204/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  (process.name : (\"powershell.exe\", \"pwsh.exe\") or process.pe.original_file_name : (\"powershell.exe\", \"pwsh.exe\")) and\n  (\n   process.parent.name : (\"wscript.exe\", \"cscript.exe\") or\n   (descendant of [process where event.action == \"start\" and process.parent.name : (\"wscript.exe\", \"cscript.exe\")] and\n    not process.parent.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\"))\n   ) and\n   process.command_line :\n             (\"*^*^*^*^*^*^*^*^*^*\",\n              \"*''*''*''*\",\n              \"*`*`*`*`*\",\n              \"*{*{*{*{*{*{*{*{*{*{*{*{*{*{*{*{*{*{*{*\",\n              \"*+*+*+*+*+*\",\n              \"*$*$*$*$*\",\n              \"*[char[]](*)*-join\",\n              \"*Base64String*\",\n              \"*[*Convert]*\",\n              \"*.Text.Encoding*\",\n              \"*.Compression.*\",\n              \"*.replace(*\",\n              \"*MemoryStream*\",\n              \"*WriteAllBytes*\",\n              \"* -en* *\",\n              \"* -ec *\",\n              \"* -e *\",\n              \"* -ep *\",\n              \"* /e *\",\n              \"* /en* *\",\n              \"* /ec *\",\n              \"* /ep *\",\n              \"*WebClient*\",\n              \"*DownloadFile*\",\n              \"*DownloadString*\",\n              \"*BitsTransfer*\",\n              \"*Invoke-Exp*\",\n              \"*invoke-web*\",\n              \"*iex*\",\n              \"*iwr*\",\n              \"*Reflection.Assembly*\",\n              \"*Assembly.GetType*\",\n              \"*.Sockets.*\",\n              \"*Add-MpPreference*ExclusionPath*\") and\n    /* false positives */\n   not process.parent.name: (\"gc_worker.exe\", \"gc_service.exe\") and\n   not process.parent.command_line : \"*Windows\\\\TEMP\\\\nessus_*\" and\n   /* Issue #247 */\n   not process.parent.executable :\n                 (\"?:\\\\Windows\\\\System32\\\\svchost.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\CompatTelRunner.exe\",\n                  \"?:\\\\Windows\\\\System32\\\\taskeng.exe\")\n",
            "rule": {
                "description": "Identifies suspicious PowerShell execution spawning from Windows Script Host processes (cscript or wscript.exe).",
                "id": "3899dd3b-f31a-4634-8467-55326cd87597",
                "name": "Suspicious PowerShell Execution via Windows Scripts",
                "reference": [],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                },
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n (process.name : (\"rundll32.exe\", \"mshta.exe\") or\n  process.pe.original_file_name in (\"MSHTA.EXE\", \"RUNDLL32.EXE\")) and\n  process.command_line :\n       (\n        \"*script*eval(*\",\n        \"*script*GetObject*\",\n        \"*.regread(*\",\n        \"*WScript.Shell*\",\n        \"*.run(*\",\n        \"*).Exec()*\",\n        \"*mshta*http://*\",\n        \"*mshtml*RunHTMLApplication*\",\n        \"*mshtml*,#135*\",\n        \"*StrReverse*\",\n        \"*.RegWrite*\"\n        )\n  /* FPs observed in telemetry */\n  and not process.parent.executable :\n                  (\"?:\\\\Program Files (x86)\\\\Citrix\\\\System32\\\\wfshell.exe\",\n                   \"?:\\\\Program Files (x86)\\\\Microsoft Office\\\\Office*\\\\MSACCESS.EXE\")\n",
            "rule": {
                "description": "Identifies the execution of scripts via HTML applications using Windows utilities rundll32.exe or mshta.exe. Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries.",
                "id": "f0630213-c4c4-4898-9514-746395eb9962",
                "name": "Script Execution via Microsoft HTML Application",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.005",
                                    "name": "Mshta",
                                    "reference": "https://attack.mitre.org/techniques/T1218/005/"
                                },
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "sequence by process.entity_id with maxspan=1m\n [process where event.action == \"start\" and process.pe.original_file_name == \"CMSTP.EXE\"]\n [library where dll.name : \"scrobj.dll\"]\n",
            "rule": {
                "description": "Identifies when scrobj.dll is loaded into the Microsoft Connection Manager Profile Installer (cmstp.exe) process. This may indicate an attempt to bypass application whitelisting by executing a malicious scriptlet in a trusted process.",
                "id": "8adfa9ad-0ed2-4b1b-bdad-f2c52e1d2a00",
                "name": "Scriptlet Execution via CMSTP",
                "reference": [
                    "https://lolbas-project.github.io/lolbas/Binaries/Cmstp/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.003",
                                    "name": "CMSTP",
                                    "reference": "https://attack.mitre.org/techniques/T1218/003/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n [file where event.action == \"rename\" and process.name : \"dllhost.exe\" and\n  file.path : \"?:\\\\Windows\\\\assembly\\\\*\\\\Accessibility.ni.dll\"]\n [process where event.action == \"start\" and\n  process.Ext.token.integrity_level_name == \"high\" and\n  process.parent.name : \"mmc.exe\" and\n  _arraysearch(process.parent.args, $arg, $arg : (\"WF.msc\", \"?:\\\\WINDOWS\\\\system32\\\\WF.msc\", \"?:\\\\WINDOWS\\\\SysWOW64\\\\WF.msc\")) and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\System32\\\\wermgr.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\wermgr.exe\")]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) by hijacking the Microsoft Management Console (MMC) Windows Firewall snap-in. Attackers bypass UAC to stealthily execute code with elevated permissions.",
                "id": "65f52068-4d08-41af-9fd7-0c1a4f732494",
                "name": "UAC Bypass via Windows Firewall Snap-In Hijack",
                "reference": [
                    "https://github.com/AzAgarampur/byeintegrity-uac"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.001",
                                    "name": "DLL Search Order Hijacking",
                                    "reference": "https://attack.mitre.org/techniques/T1574/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id with maxspan=30s\n  [process where event.action == \"start\" and process.name : \"EQNEDT32.EXE\" and _arraysearch(process.args, $arg, $arg : \"-Embedding\")]\n  [network where event.action in (\"connection_attempted\", \"connection_accepted\") and process.name : \"EQNEDT32.EXE\"]\n",
            "rule": {
                "description": "Identifies a suspicious network connection from the Microsoft Equation Editor process, which is frequently targeted by attackers using weaponized Microsoft Office documents. This behavior is consistent with the successful exploitation of Office applications via known vulnerabilities CVE-2017-1182 or CVE-2018-0798.",
                "id": "365571bb-2b93-4ae8-8c39-0558f8a6c4cc",
                "name": "Suspicious Network Connection from Microsoft Equation Editor",
                "reference": [
                    "https://www.anomali.com/blog/multiple-chinese-threat-groups-exploiting-cve-2018-0798-equation-editor-vulnerability-since-late-2018",
                    "https://nvd.nist.gov/vuln/detail/CVE-2017-11882",
                    "https://nvd.nist.gov/vuln/detail/CVE-2018-0798"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1203",
                            "name": "Exploitation for Client Execution",
                            "reference": "https://attack.mitre.org/techniques/T1203/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id with maxspan=5m\n [process where event.action == \"start\" and\n  (process.parent.name : (\"EQNEDT32.EXE\", \"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSPUB.EXE\", \"MSACCESS.EXE\") or\n   descendant of [process where event.action == \"start\" and\n                  process.name :\n                       (\"EQNEDT32.EXE\",\n                        \"WINWORD.EXE\",\n                        \"EXCEL.EXE\",\n                        \"POWERPNT.EXE\",\n                        \"MSPUB.EXE\",\n                        \"MSACCESS.EXE\")]) and\n   /* Issue #334 */\n   not process.Ext.token.integrity_level_name == \"system\"]\n [file where event.action != \"deletion\" and\n  file.path : (\"?:\\\\Users\\\\*\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\",\n               \"?:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\*\") and\n  /* Issue #334 */\n  not file.name : \"desktop.ini\"]\n",
            "rule": {
                "description": "Identifies files written to or modified in the startup folder by a Microsoft Office descendant process. Adversaries may use this technique to maintain persistence and to avoid spawning suspicious child processes in an attempt to evade detection.",
                "id": "c01cddb6-bbcf-437c-8256-6b4d44c6bdc3",
                "name": "Startup Persistence via Microsoft Office Descendant Process",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "sequence by process.entity_id with maxspan=2m\n[process where event.action == \"start\" and\n   (process.name : \"WMIC.exe\" or process.pe.original_file_name : \"wmic.exe\") and\n   process.command_line : (\"* format*:*\", \"*/format*:*\", \"*-format*:*\") and\n   not process.command_line :\n              (\n               \"*format:list*\",\n               \"*format:table*\",\n               \"*format:htable\",\n               \"*format:texttablewsys*\",\n               \"*format:texttable*\",\n               \"*format:textvaluelist*\",\n               \"*format:TEXTVALUELIST*\",\n               \"*format:csv*\",\n               \"*format:value*\"\n               )\n]\n[library where dll.name : (\"jscript.dll\", \"vbscript.dll\")]\n",
            "rule": {
                "description": "Identifies Windows Management Instrumentation Command-Line utility (WMIC) whitelisting bypass attempts by alerting on suspicious execution of scripts. When WMIC loads scripting libraries, it may be indicative of a whitelist bypass attempt.",
                "id": "18371ec4-ee2f-465b-8757-ee726914006c",
                "name": "Suspicious WMIC XSL Script Execution",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1220",
                            "name": "XSL Script Processing",
                            "reference": "https://attack.mitre.org/techniques/T1220/",
                            "subtechnique": null
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1047",
                            "name": "Windows Management Instrumentation",
                            "reference": "https://attack.mitre.org/techniques/T1047/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n   [process where event.action == \"start\"]\n   [registry where registry.path : \"*\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SilentProcessExit\\\\lsass*\"]\n",
            "rule": {
                "description": "Identifies the modification of the Image File Execution Options SilentProcessExit key that can be abused to dump LSASS memory via the Windows Error Reporting WerFault.exe. Adversaries may use this technique for credential access.",
                "id": "28969fe6-0ebe-4442-b40c-dbe9b4234f5e",
                "name": "LSA Dump via SilentProcessExit",
                "reference": [
                    "https://www.deepinstinct.com/2021/02/16/lsass-memory-dumps-are-stealthier-than-ever-before-part-2/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0006",
                        "name": "Credential Access",
                        "reference": "https://attack.mitre.org/tactics/TA0006/"
                    },
                    "technique": [
                        {
                            "id": "T1003",
                            "name": "OS Credential Dumping",
                            "reference": "https://attack.mitre.org/techniques/T1003/",
                            "subtechnique": [
                                {
                                    "id": "T1003.001",
                                    "name": "LSASS Memory",
                                    "reference": "https://attack.mitre.org/techniques/T1003/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 2,
            "query": "sequence with maxspan=60s\n [registry where\n   registry.path : \"HKEY_USERS\\\\S-1-5-21*\\\\Environment\\\\COR_PROFILER_PATH\" and\n   _arraysearch(registry.data.strings, $arg, $arg : \"*.dll\")]\n [process where event.action == \"start\" and process.name : \"mmc.exe\"]\n [process where event.action == \"start\" and\n  process.parent.name : \"mmc.exe\" and process.Ext.token.integrity_level_name == \"high\" and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\")]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via DLL search order hijacking by setting the .NET Core profiler environment variable to force MMC loading a malicious DLL. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.",
                "id": "28996098-b9be-4aa8-a1f3-4923c84b2649",
                "name": "UAC Bypass Attempt via MMC DLL Search Order Hijacking",
                "reference": [
                    "https://github.com/hfiref0x/UACME"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.001",
                                    "name": "DLL Search Order Hijacking",
                                    "reference": "https://attack.mitre.org/techniques/T1574/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and process.args_count <= 5 and\n process.pe.original_file_name : \"msiexec.exe\" and _arraysearch(process.args, $arg, $arg : \"http*\") and\n _arraysearch(process.args, $arg, $arg : (\"/i\", \"-i\")) and \n _arraysearch(process.args, $arg, $arg : (\"/q\", \"/quiet\", \"/qn\", \"-q\", \"-quiet\", \"-qn\")) and\n not descendant of \n       [process where event.action == \"start\" and process.name : \"*setup*\" and process.code_signature.trusted == true] and\n not process.Ext.token.integrity_level_name == \"system\"\n",
            "rule": {
                "description": "Identifies the execution of the built-in Windows Installer, MSIEXEC, with a url in the command line. Adversaries may abuse msiexec.exe to launch local or network accessible MSI files.",
                "id": "8ba98e28-d83e-451e-8df7-f0964f7e69b6",
                "name": "Remote File Execution via MSIEXEC",
                "reference": [
                    "https://lolbas-project.github.io/lolbas/Binaries/Msiexec/",
                    "https://www.guardicore.com/labs/purple-fox-rootkit-now-propagates-as-a-worm/"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.007",
                                    "name": "Msiexec",
                                    "reference": "https://attack.mitre.org/techniques/T1218/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=1m\n  [process where event.action == \"start\" and process.name : \"cmd.exe\" and\n    not process.parent.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\")\n  ] by process.entity_id\n  [process where event.action == \"start\" and\n    (\n     (process.pe.original_file_name : \"wmic.exe\" and process.command_line : \"*shadowcopy*\" and process.command_line : \"*delete*\") or\n     (process.pe.original_file_name : \"vssadmin.exe\" and process.command_line : \"*shadows*\" and process.command_line : \"*delete*\") or\n     (process.pe.original_file_name : \"bcdedit.exe\" and process.command_line : (\"*bootstatuspolicy*\", \"*recoveryenabled*\")) or\n     (process.pe.original_file_name : \"wbadmin.exe\" and process.command_line : (\"*catalog*\", \"*systemstatebackup*\") and process.command_line : \"*delete*\")\n    )\n  ] by process.parent.entity_id\n",
            "rule": {
                "description": "Identifies the execution of Windows utilities to tamper with system recovery settings. Adversaries may delete or remove built-in operating system data and turn off services designed to aid in the recovery of a corrupted system and prevent recovery.",
                "id": "d3588fad-43ae-4f2d-badd-15a27df72133",
                "name": "Inhibit System Recovery via Windows Command Shell",
                "reference": [],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0040",
                        "name": "Impact",
                        "reference": "https://attack.mitre.org/tactics/TA0040/"
                    },
                    "technique": [
                        {
                            "id": "T1490",
                            "name": "Inhibit System Recovery",
                            "reference": "https://attack.mitre.org/techniques/T1490/",
                            "subtechnique": null
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1047",
                            "name": "Windows Management Instrumentation",
                            "reference": "https://attack.mitre.org/techniques/T1047/",
                            "subtechnique": null
                        },
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.003",
                                    "name": "Windows Command Shell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/003/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n [process where event.action == \"start\" and \n  /* Issue #288 */\n  process.executable : (\"?:\\\\Windows\\\\System32\\\\*.exe\", \n                        \"?:\\\\Windows\\\\SysWOW64\\\\*.exe\", \n                        \"?:\\\\Windows\\\\Microsoft.NET\\\\*.exe\") and\n  not process.executable : (\"?:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\",\n                            \"?:\\\\Windows\\\\SysWOW64\\\\wbem\\\\WmiPrvSE.exe\") and\n  not (process.name : \"rundll32.exe\" and process.command_line : \"*zzzzInvokeManagedCustomActionOutOfProc*\") and \n  not (process.name : \"dllhost.exe\" and process.command_line : \"*BD07DDB9-1C61-4DCE-9202-A2BA1757CDB2*\")]\n [library where dll.name : (\"System.Management.Automation.ni.dll\", \"System.Management.Automation.dll\") and not\n  process.name :\n   (\n    \"Altaro.SubAgent.exe\",\n    \"AppV_Manage.exe\",\n    \"azureadconnect.exe\",\n    \"CcmExec.exe\",\n    \"configsyncrun.exe\",\n    \"choco.exe\",\n    \"ctxappvservice.exe\",\n    \"DVLS.Console.exe\",\n    \"edgetransport.exe\",\n    \"exsetup.exe\",\n    \"forefrontactivedirectoryconnector.exe\",\n    \"InstallUtil.exe\",\n    \"JenkinsOnDesktop.exe\",\n    \"Microsoft.EnterpriseManagement.ServiceManager.UI.Console.exe\",\n    \"mmc.exe\",\n    \"mscorsvw.exe\",\n    \"msexchangedelivery.exe\",\n    \"msexchangefrontendtransport.exe\",\n    \"msexchangehmworker.exe\",\n    \"msexchangesubmission.exe\",\n    \"msiexec.exe\",\n    \"MsiExec.exe\",\n    \"noderunner.exe\",\n    \"NServiceBus.Host.exe\",\n    \"NServiceBus.Host32.exe\",\n    \"NServiceBus.Hosting.Azure.HostProcess.exe\",\n    \"OuiGui.WPF.exe\",\n    \"powershell.exe\",\n    \"powershell_ise.exe\",\n    \"pwsh.exe\",\n    \"SCCMCliCtrWPF.exe\",\n    \"ScriptEditor.exe\",\n    \"ScriptRunner.exe\",\n    \"sdiagnhost.exe\",\n    \"servermanager.exe\",\n    \"setup100.exe\",\n    \"ServiceHub.VSDetouredHost.exe\",\n    \"SPCAF.Client.exe\",\n    \"SPCAF.SettingsEditor.exe\",\n    \"SQLPS.exe\",\n    \"telemetryservice.exe\",\n    \"UMWorkerProcess.exe\",\n    \"w3wp.exe\",\n    \"wsmprovhost.exe\",\n    \"dsac.exe\",\n    \"RemoteFXvGPUDisablement.exe\")]\n",
            "rule": {
                "description": "Identifies the PowerShell engine being invoked by unexpected processes. Instead of executing PowerShell functionality with powershell.exe, some attackers do this to operate more stealthily.",
                "id": "f57505bb-a1d2-4d3b-b7b5-1d81d7bdb80e",
                "name": "Unusual PowerShell Engine ImageLoad",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.pe.original_file_name : (\"cscript.exe\", \"wscript.exe\") and\n _arraysearch(process.args, $arg, $arg : (\"-e:*\", \"/e:*\", \"//e:*\")) and\n not _arraysearch(process.args, $arg, $arg : (\"*.js*\", \"*.vb*\", \"*.wsf*\", \"*.wsh*\", \"*.wsc*\", \"*.tmp*\")) and \n /* Issue #286 */\n not process.parent.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\") and \n not process.command_line : (\"*:\\\\Program Files\\\\*\", \"*:\\\\Program Files (x86)\\\\*\", \"*\\\\Windows\\\\system32\\\\spool\\\\DRIVERS\\\\*\")\n",
            "rule": {
                "description": "Identifies the execution of a script with an unusual file extension by Windows Script Host processes (cscript or wscript).",
                "id": "b76c0a04-b504-4a2f-a0cf-b4175a2f3eea",
                "name": "Execution of a Windows Script with Unusual File Extension",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "sequence by process.entity_id with maxspan=30s\n  [dns where dns.question.type == \"TXT\" and length(dns.question.name) > 20 and dns.question.name : \"*aa.stage.*.*.*\"]\n  [dns where dns.question.type == \"TXT\" and length(dns.question.name) > 20 and dns.question.name : \"*aa.stage.*.*.*\"]\n  [dns where dns.question.type == \"TXT\" and length(dns.question.name) > 20 and dns.question.name : \"*aa.stage.*.*.*\"]\n  [dns where dns.question.type == \"TXT\" and length(dns.question.name) > 20 and dns.question.name : \"*aa.stage.*.*.*\"]\n  [dns where dns.question.type == \"TXT\" and length(dns.question.name) > 20 and dns.question.name : \"*aa.stage.*.*.*\"]\n  [dns where dns.question.type == \"TXT\" and length(dns.question.name) > 20 and dns.question.name : \"*aa.stage.*.*.*\"]\n  [dns where dns.question.type == \"TXT\" and length(dns.question.name) > 20 and dns.question.name : \"*aa.stage.*.*.*\"]\n  [dns where dns.question.type == \"TXT\" and length(dns.question.name) > 20 and dns.question.name : \"*aa.stage.*.*.*\"]\n  [dns where dns.question.type == \"TXT\" and length(dns.question.name) > 20 and dns.question.name : \"*aa.stage.*.*.*\"]\n  [dns where dns.question.type == \"TXT\" and length(dns.question.name) > 20 and dns.question.name : \"*aa.stage.*.*.*\"]\n",
            "rule": {
                "description": "Identifies a suspicious sequence of DNS TXT record queries that match the default Cobalt Strike DNS Beacon staging configuration.",
                "id": "19dfd99d-89a5-4d1d-9f20-4bba3a09b391",
                "name": "Potential Cobaltstrike DNS Stager",
                "reference": [
                    "https://blog.cobaltstrike.com/2015/05/14/an-unnecessary-addiction-to-dns-communication/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0011",
                        "name": "Command and Control",
                        "reference": "https://attack.mitre.org/tactics/TA0011/"
                    },
                    "technique": [
                        {
                            "id": "T1071",
                            "name": "Application Layer Protocol",
                            "reference": "https://attack.mitre.org/techniques/T1071/",
                            "subtechnique": [
                                {
                                    "id": "T1071.004",
                                    "name": "DNS",
                                    "reference": "https://attack.mitre.org/techniques/T1071/004/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.parent.name : \"dllhost.exe\" and\n process.Ext.token.integrity_level_name == \"high\" and\n process.parent.command_line : \"*BD54C901-076B-434E-B6C7-17C531F4AB41*\" and \n process.executable : (\"?:\\\\*\\\\System32\\\\*.exe\", \"?:\\\\*\\\\SysWOW64\\\\*.exe\") and\n not process.executable : (\"?:\\\\Windows\\\\System32\\\\*.exe\", \"?:\\\\Windows\\\\SysWOW64\\\\*.exe\")\n \n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) by abusing an elevated COM interface to launch a rogue Windows ClipUp program. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.",
                "id": "f1008eeb-bc85-4d5e-91ac-e99aaba08ecf",
                "name": "UAC Bypass Attempt with IEditionUpgradeManager Elevated COM Interface",
                "reference": [
                    "https://github.com/hfiref0x/UACME"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 2,
            "query": "sequence with maxspan=5m\n  [ process where event.action == \"start\" and\n    process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\")] by process.entity_id\n  [ file where event.action != \"deletion\" and\n      process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\") and\n      (\n        file.extension : (\"exe\", \"com\") or\n        // Match Windows PE files by header data (MZ)\n        (file.Ext.header_data[0] == 77 and\n        file.Ext.header_data[1] == 90)\n      )\n  ] by process.entity_id\n  [ process where event.action == \"start\" and\n      process.parent.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\") and\n      process.name : (\"rundll32.exe\", \"regsvr32.exe\") and\n      process.args_count >= 2 ] by process.parent.entity_id\n",
            "rule": {
                "description": "Identifies when a Microsoft Office process creates a portable executable (PE) file and the file is subsequently executed using rundll32.exe or regsvr32.exe. In an attempt to evade detection, an adversary may deliver a weaponized Office document to their target that writes and executes a malicious PE file.",
                "id": "901f0c30-a7c5-40a5-80e3-a50c6744632f",
                "name": "Execution of Suspicious File via RunDLL32 or Regsvr32",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                },
                                {
                                    "id": "T1566.002",
                                    "name": "Spearphishing Link",
                                    "reference": "https://attack.mitre.org/techniques/T1566/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                },
                                {
                                    "id": "T1059.003",
                                    "name": "Windows Command Shell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/003/"
                                },
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.011",
                                    "name": "Rundll32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/011/"
                                },
                                {
                                    "id": "T1218.010",
                                    "name": "Regsvr32",
                                    "reference": "https://attack.mitre.org/techniques/T1218/010/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n  [process where event.action == \"start\"]\n  [registry where registry.data.strings[0] != null and\n    registry.path : (\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\"\n    ) and\n  startswith(registry.value, \"*\") and\n  /* Issue #318 */\n  not (process.name : \"Lmi_Rescue_srv.exe\" and registry.value : \"*LogMeInRescue*\")\n  ]\n",
            "rule": {
                "description": "Run and RunOnce registry keys cause programs to run each time that a user logs on. By default, these keys are ignored when the computer is started in Safe Mode. The value name of RunOnce keys can be prefixed with an asterisk (*) to force the program to run even in Safe Mode. Attackers have been observed in the wild using this technique to execute ransomware in Safe Mode.",
                "id": "94d35931-5c48-49ed-8c18-d601c4f8aeaa",
                "name": "Registry Run Key Prefixed with Asterisk",
                "reference": [
                    "https://docs.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys",
                    "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  (process.name : (\"powershell.exe\", \"pwsh.exe\") or process.pe.original_file_name : (\"powershell.exe\", \"pwsh.exe\")) and\n  _arraysearch(process.args, $arg, $arg : (\"*.downloadstring*\", \"*.downloadfile*\", \"*.downloaddata*\", \"*BitsTransfer*\")) and\n  (process.parent.name : (\n      \"winword.exe\",\n      \"excel.exe\",\n      \"outlook.exe\",\n      \"powerpnt.exe\",\n      \"eqnedt32.exe\",\n      \"fltldr.exe\",\n      \"mspub.exe\",\n      \"msaccess.exe\",\n      \"acrord32.exe\",\n      \"rdrcef.exe\",\n      \"foxitphantomPDF.exe\",\n      \"foxitreader.exe\",\n      \"firefox.exe\",\n      \"chrome.exe\",\n      \"iexplore.exe\",\n      \"opera.exe\",\n      \"plugin-container.exe\",\n      \"safari.exe\",\n      \"microsoftedge.exe\",\n      \"w3wp.exe\",\n      \"httpd.exe\",\n      \"nginx.exe\",\n      \"php.exe\",\n      \"php-cgi.exe\",\n      \"tomcat.exe\",\n      \"wscript.exe\",\n      \"cscript.exe\"\n      ) or\n  descendant of [process where event.action == \"start\" and\n    process.parent.name : (\n      \"winword.exe\",\n      \"excel.exe\",\n      \"outlook.exe\",\n      \"powerpnt.exe\",\n      \"eqnedt32.exe\",\n      \"fltldr.exe\",\n      \"mspub.exe\",\n      \"msaccess.exe\",\n      \"acrord32.exe\",\n      \"rdrcef.exe\",\n      \"foxitphantomPDF.exe\",\n      \"foxitreader.exe\",\n      \"firefox.exe\",\n      \"chrome.exe\",\n      \"iexplore.exe\",\n      \"opera.exe\",\n      \"plugin-container.exe\",\n      \"safari.exe\",\n      \"microsoftedge.exe\",\n      \"w3wp.exe\",\n      \"httpd.exe\",\n      \"nginx.exe\",\n      \"php.exe\",\n      \"php-cgi.exe\",\n      \"tomcat.exe\",\n      \"wscript.exe\",\n      \"cscript.exe\"\n    )])\n",
            "rule": {
                "description": "Identifies PowerShell processes that attempted to download files and were descendants of Microsoft Office, document viewers, web browsers, or other business application software.",
                "id": "7200673e-588c-45d5-be48-bc5c7a908d6b",
                "name": "Suspicious PowerShell Downloads",
                "reference": [],
                "severity": "low",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                },
                                {
                                    "id": "T1566.002",
                                    "name": "Spearphishing Link",
                                    "reference": "https://attack.mitre.org/techniques/T1566/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n [registry where registry.hive == \"HKEY_USERS\" and registry.data.strings[0] != null and\n   registry.key : \"*\\\\ms-settings*\"]\n [process where event.action == \"start\" and process.parent.name : \"fodhelper.exe\" and\n  process.Ext.token.integrity_level_name == \"high\" and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\")]\n",
            "rule": {
                "description": "Identifies User Account Control (UAC) bypass via fodhelper.exe execution hijack. Attackers bypass UAC to stealthily execute code with elevated permissions.",
                "id": "b5c0058e-2bca-4ed5-84b3-4e017c039c57",
                "name": "UAC Bypass via FodHelper Execution Hijack",
                "reference": [
                    "https://github.com/hfiref0x/UACME"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.parent.name : \"sdclt.exe\" and process.parent.command_line : \"*/kickoffelev*\" and\n process.Ext.token.integrity_level_name == \"high\" and\n not process.executable :\n           (\"?:\\\\Windows\\\\SysWOW64\\\\sdclt.exe\",\n            \"?:\\\\Windows\\\\System32\\\\sdclt.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\control.exe\",\n            \"?:\\\\Windows\\\\System32\\\\control.exe\",\n            \"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\System32\\\\wermgr.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\wermgr.exe\")\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via sdclt.exe. Attackers bypass UAC to stealthily execute code with elevated permissions.",
                "id": "e9095298-65e0-40a2-97c9-055de8685645",
                "name": "UAC Bypass via Sdclt",
                "reference": [
                    "https://github.com/hfiref0x/UACME"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n process.parent.name : \"wmic.exe\" and\n not process.executable :\n            (\"?:\\\\Windows\\\\System32\\\\conhost.exe\",\n             \"?:\\\\Windows\\\\system32\\\\wbem\\\\WMIC.exe\",\n             \"?:\\\\Windows\\\\syswow64\\\\wbem\\\\WMIC.exe\",\n             \"?:\\\\Windows\\\\system32\\\\WerFault.exe\",\n             \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\")\n",
            "rule": {
                "description": "Identifies unusual child processes of the Windows Management Instrumentation Command-Line utility (WMIC). An adversary may attempt to bypass whitelisting controls in order to execute malicious scripts.",
                "id": "3f51ad68-9a27-4ca9-aa36-f60b37ad4fba",
                "name": "Unusual WMIC Child Process",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1220",
                            "name": "XSL Script Processing",
                            "reference": "https://attack.mitre.org/techniques/T1220/",
                            "subtechnique": null
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1047",
                            "name": "Windows Management Instrumentation",
                            "reference": "https://attack.mitre.org/techniques/T1047/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n [process where event.action == \"start\" and process.executable : \"?:\\\\Windows\\\\*\" and\n  not process.executable : \"?:\\\\Windows\\\\Temp\\\\*.exe\" and\n  not user.id : \"S-1-5-18\" and\n  not process.name :\n           (\"wscript.exe\",\n            \"cscript.exe\",\n            \"powershell.exe\",\n            \"explorer.exe\",\n            \"dllhost.exe\",\n            \"notepad.exe\",\n            \"cmd.exe\",\n            \"Robocopy.exe\",\n            \"wuauclt.exe\",\n            \"msiexec.exe\",\n            \"CompPkgSrv.exe\") and \n  /* Issue #297 */\n  not (process.name : \"rundll32.exe\" and process.command_line : \"*\\\\WINDOWS\\\\system32\\\\spool\\\\DRIVERS\\\\x64\\\\3\\\\*\")]\n [file where event.action != \"deletion\" and\n  file.path : (\"?:\\\\Users\\\\*\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\",\n               \"?:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp\\\\*\") and\n  /* Issue #297 */\n  not file.name : \"desktop.ini\" and\n  not process.executable : \"?:\\\\Windows\\\\Application Compatibility Scripts\\\\acregl.exe\"\n  ]\n",
            "rule": {
                "description": "Identifies files written to or modified in the startup folder by an unusual Microsoft process. Adversaries may use this technique to maintain persistence.",
                "id": "95d13ce1-ffb2-4be8-a56e-cc9a891e81e2",
                "name": "Startup Persistence via Unusual Process",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n (process.pe.original_file_name == \"procdump\" and _arraysearch(process.args, $arg, $arg : \"-ma\")) or\n (process.name : \"ProcessDump.exe\" and not process.parent.executable : \"?:\\\\Program Files*\\\\Cisco Systems\\\\*.exe\") or\n (process.pe.original_file_name == \"WriteMiniDump.exe\" and not process.parent.executable : \"?:\\\\Program Files*\\\\Steam\\\\*.exe\") or\n (process.pe.original_file_name == \"RUNDLL32.EXE\" and process.command_line : (\"*comsvcs*#24*\", \"*MiniDump*\")) or\n (process.pe.original_file_name == \"RdrLeakDiag.exe\" and _arraysearch(process.args, $arg, $arg : \"/fullmemdmp\")) or\n (process.pe.original_file_name == \"SqlDumper.exe\" and _arraysearch(process.args, $arg, $arg : \"0x01100*\")) or\n (process.pe.original_file_name == \"TTTracer.exe\" and _arraysearch(process.args, $arg, $arg : \"-dumpFull\") and\n  _arraysearch(process.args, $arg, $arg : \"-attach\")) or\n (process.pe.original_file_name == \"ntdsutil.exe\" and process.command_line : \"*create*full*\") or\n (process.pe.original_file_name == \"diskshadow.exe\" and _arraysearch(process.args, $arg, $arg : \"/s\"))\n",
            "rule": {
                "description": "Identifies the execution of known Windows utilities often abused to dump LSASS memory or the Active Directory database (NTDS.dit) in preparation for credential access.",
                "id": "3c44fc50-2672-48b3-af77-ff43b895ac70",
                "name": "Credential Access via Known Utilities",
                "reference": [
                    "https://lolbas-project.github.io/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0006",
                        "name": "Credential Access",
                        "reference": "https://attack.mitre.org/tactics/TA0006/"
                    },
                    "technique": [
                        {
                            "id": "T1003",
                            "name": "OS Credential Dumping",
                            "reference": "https://attack.mitre.org/techniques/T1003/",
                            "subtechnique": [
                                {
                                    "id": "T1003.001",
                                    "name": "LSASS Memory",
                                    "reference": "https://attack.mitre.org/techniques/T1003/001/"
                                },
                                {
                                    "id": "T1003.003",
                                    "name": "NTDS",
                                    "reference": "https://attack.mitre.org/techniques/T1003/003/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n  [process where event.action == \"start\" and process.executable: \"?:\\\\Windows\\\\*.exe\" and\n   /* Issue #314 */\n   not process.executable : (\"?:\\\\Windows\\\\LTSvc\\\\LTSVC.exe\",\n                             \"?:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\")]\n  [network where network.direction == \"outgoing\" and\n   destination.port == 3389 and source.port >= 49152 and\n   not process.executable :\n                     (\"?:\\\\Windows\\\\System32\\\\mstsc.exe\",\n                      \"?:\\\\Windows\\\\SysWOW64\\\\mstsc.exe\",\n                      \"?:\\\\Windows\\\\SysWOW64\\\\svchost.exe\",\n                      \"?:\\\\Windows\\\\System32\\\\svchost.exe\",\n                      /* Issue #314 */\n                      \"?:\\\\Windows\\\\System32\\\\telnet.exe\",\n                      \"?:\\\\Windows\\\\SysWOW64\\\\telnet.exe\")]\n",
            "rule": {
                "description": "Identifies a Remote Desktop Protocol (RDP) network connection from an unusual client process. Adversaries may attempt to connect to a remote system over RDP to achieve lateral movement and in some cases, may avoid using the Microsoft Terminal Services Client (mstsc.exe) binary in an attempt to evade detection.",
                "id": "d448566e-486f-4b61-a76f-945662313d49",
                "name": "Unusual Remote Desktop Client Process",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0008",
                        "name": "Lateral Movement",
                        "reference": "https://attack.mitre.org/tactics/TA0008/"
                    },
                    "technique": [
                        {
                            "id": "T1021",
                            "name": "Remote Services",
                            "reference": "https://attack.mitre.org/techniques/T1021/",
                            "subtechnique": [
                                {
                                    "id": "T1021.001",
                                    "name": "Remote Desktop Protocol",
                                    "reference": "https://attack.mitre.org/techniques/T1021/001/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=5m\n  [process where event.action == \"start\" and not process.executable:(\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\") and\n    not process.code_signature.trusted == true\n  ] by process.entity_id\n  [process where event.action == \"start\" and\n    (\n      (process.pe.original_file_name : \"wmic.exe\" and process.command_line : \"*shadowcopy*\" and process.command_line : \"*delete*\") or\n      (process.pe.original_file_name : \"vssadmin.exe\" and process.command_line : \"*shadows*\" and process.command_line : \"*delete*\") or\n      (process.pe.original_file_name : \"bcdedit.exe\" and process.command_line : (\"*bootstatuspolicy*\", \"*recoveryenabled*\")) or\n      (process.pe.original_file_name : \"wbadmin.exe\" and process.command_line : (\"*catalog*\", \"*systemstatebackup*\") and process.command_line : \"*delete*\")\n    )\n  ] by process.parent.entity_id\n",
            "rule": {
                "description": "Identifies the execution of Windows utilities to tamper with system recovery settings. Adversaries may delete or remove built-in operating system data and turn off services designed to aid in the recovery of a corrupted system and prevent recovery.",
                "id": "d3588fad-43ae-4f2d-badd-15a27df72132",
                "name": "Inhibit System Recovery via Untrusted Parent Process",
                "reference": [],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0040",
                        "name": "Impact",
                        "reference": "https://attack.mitre.org/tactics/TA0040/"
                    },
                    "technique": [
                        {
                            "id": "T1490",
                            "name": "Inhibit System Recovery",
                            "reference": "https://attack.mitre.org/techniques/T1490/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n  [process where event.action == \"start\" and not\n   (process.executable : (\"?:\\\\Program Files\\\\*.exe\", \"?:\\\\Program Files (x86)\\\\*.exe\") and\n    process.code_signature.trusted == true) and not\n    process.executable : (\"?:\\\\Windows\\\\SysWOW64\\\\msiexec.exe\", \"?:\\\\Windows\\\\system32\\\\msiexec.exe\") and not\n    user.id : \"S-1-5-18\"]\n  [registry where registry.data.strings[0] != null and\n    registry.path : (\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n      \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\",\n      \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\") and\n   (\n     /* hidden run key value */\n     registry.path : (\"HKEY_USERS\\\\*\\\\Run\\\\\", \"HKLM\\\\*\\\\Run\\\\\") or\n\n     /* suspicious value names */\n    (registry.value :\n         (\"*.exe\",\n         \"svchost*\",\n         \"winlogon*\",\n         \"google*\",\n         \"lsass*\",\n         \"taskhost*\",\n         \"*gmail*\",\n         \"*Java*\",\n         \"chrome*\",\n         \"CrashDumpReport\",\n         \"*Windows*\",\n         \"*Updater*\",\n         \"SysHelper*\",\n         \"Adobe*\",\n         \"remcos\", /* Remcos RAT */\n         \"Yahoo*\") and not\n    _arraysearch(registry.data.strings, $arg, $arg :\n                   (\"*%ProgramFiles%*\",\n                    \"*:\\\\Program Files\\\\*\",\n                    \"*:\\\\Program Files (x86)\\\\*\")) and not\n   (registry.value : (\"google*\", \"chrome*\") and process.name : (\"GoogleUpdate.exe\", \"brave.exe\", \"GoogleInstApp.exe\")))\n   ) and\n    /* Issue #299 */\n    not (process.name : \"userinit.exe\" and registry.value : \"ctfmon.exe\")\n   ]\n",
            "rule": {
                "description": "Identifies suspicious Run and RunOnce registry key value names masquerading as popular software or update services. Run and RunOnce registry keys cause programs to run each time that a user logs on and are often abused by adversaries to maintain persistence on an endpoint.",
                "id": "dca2528e-af83-40dc-a608-3f09ad1d53ec",
                "name": "Suspicious Value Name Written to Registry Run Key",
                "reference": [
                    "https://docs.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1036",
                            "name": "Masquerading",
                            "reference": "https://attack.mitre.org/techniques/T1036/",
                            "subtechnique": [
                                {
                                    "id": "T1036.005",
                                    "name": "Match Legitimate Name or Location",
                                    "reference": "https://attack.mitre.org/techniques/T1036/005/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id with maxspan=1m\n [process where event.action == \"start\" and\n  // unsigned program starting from startup folder\n  (process.executable : (\n   \"?:\\\\Users\\\\*\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\",\n   \"?:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\")  and\n   not process.code_signature.trusted == true) or\n  // Scripts starting from startup folder\n  (process.name : (\"cscript.exe\", \"wscript.exe\", \"mshta.exe\", \"powershell.exe\") and\n   process.command_line : (\n  \"*:\\\\Users\\\\*\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\",\n  \"*:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\") )]\n [network where true]\n",
            "rule": {
                "description": "Identifies the execution of an unsigned program or script from the Startup shell folder followed by an immediate network connection. This may indicate the presence of a malicious persistent item.",
                "id": "0b33141a-3f73-4414-ba90-d8410e6ab176",
                "name": "Network Connection via Startup Item",
                "reference": [],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                },
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1218",
                            "name": "Signed Binary Proxy Execution",
                            "reference": "https://attack.mitre.org/techniques/T1218/",
                            "subtechnique": [
                                {
                                    "id": "T1218.005",
                                    "name": "Mshta",
                                    "reference": "https://attack.mitre.org/techniques/T1218/005/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "sequence by process.entity_id with maxspan=1m\n [process where event.action == \"start\" and process.pe.original_file_name == \"msxsl.exe\"]\n [library where dll.name : (\"scrobj.dll\", \"jscript.dll\", \"vbscript.dll\", \"jscript9.dll\")]\n",
            "rule": {
                "description": "Identifies when a Windows Script module is loaded into the Microsoft Core XML Services (MSXML) process. This may indicate an attempt to bypass application whitelisting by executing a malicious script in a trusted process.",
                "id": "de3615bc-4e50-485e-b3b5-8548ef6faa3d",
                "name": "Script Execution via MSXSL",
                "reference": [
                    "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Msxsl/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1220",
                            "name": "XSL Script Processing",
                            "reference": "https://attack.mitre.org/techniques/T1220/",
                            "subtechnique": null
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=60s\n [file where event.action : \"rename\" and process.name : (\"dllhost.exe\", \"wusa.exe\") and\n  file.name : \"DismCore.dll\" and\n  not file.path : (\"?:\\\\Windows\\\\SoftwareDistribution\\\\*.dll\", \"?:\\\\Windows\\\\WinSxS\\\\*.dll\")]\n [process where event.action == \"start\" and\n  process.parent.name : \"Dism.exe\" and process.Ext.token.integrity_level_name == \"high\" and\n  not process.executable :\n           (\"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\WerFault.exe\",\n            \"?:\\\\Windows\\\\System32\\\\wermgr.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\wermgr.exe\",\n            \"?:\\\\Windows\\\\System32\\\\conhost.exe\",\n            \"?:\\\\Windows\\\\SysWOW64\\\\conhost.exe\") and\n  not (process.pe.original_file_name == \"DismHost.exe\" and process.code_signature.trusted == true and\n       process.code_signature.subject_name : \"Microsoft *\")\n  ]\n",
            "rule": {
                "description": "Identifies attempts to bypass User Account Control (UAC) via DLL side-loading. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.",
                "id": "38210b91-f593-4c1c-a582-e5309c5b5168",
                "name": "UAC Bypass Attempt via DismCore DLL Side-Loading",
                "reference": [
                    "https://github.com/hfiref0x/UACME",
                    "https://app.any.run/tasks/6f2eb616-7786-4d42-9345-b682bda65c6b/"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1548",
                            "name": "Abuse Elevation Control Mechanism",
                            "reference": "https://attack.mitre.org/techniques/T1548/",
                            "subtechnique": [
                                {
                                    "id": "T1548.002",
                                    "name": "Bypass User Account Control",
                                    "reference": "https://attack.mitre.org/techniques/T1548/002/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1574",
                            "name": "Hijack Execution Flow",
                            "reference": "https://attack.mitre.org/techniques/T1574/",
                            "subtechnique": [
                                {
                                    "id": "T1574.002",
                                    "name": "DLL Side-Loading",
                                    "reference": "https://attack.mitre.org/techniques/T1574/002/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": " process where event.action == \"start\" and\n   process.pe.original_file_name in (\"Cmd.Exe\", \"PowerShell.EXE\") and process.command_line : \"*echo*>*\\\\\\\\.\\\\pipe\\\\*\"\n",
            "rule": {
                "description": "Identifies a privilege escalation attempt via named pipe impersonation. An adversary may abuse this technique by utilizing a framework like Metasploit's getsystem command.",
                "id": "a0265178-779d-4bc5-b3f1-abb3bcddedab",
                "name": "Privilege Escalation via Named Pipe Impersonation",
                "reference": [
                    "https://www.ired.team/offensive-security/privilege-escalation/windows-namedpipes-privilege-escalation"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0004",
                        "name": "Privilege Escalation",
                        "reference": "https://attack.mitre.org/tactics/TA0004/"
                    },
                    "technique": [
                        {
                            "id": "T1134",
                            "name": "Access Token Manipulation",
                            "reference": "https://attack.mitre.org/techniques/T1134/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence with maxspan=1m\n  [file where event.action != \"deletion\" and\n   (file.extension : (\"exe\", \"com\") or (file.Ext.header_data[0] == 77 and file.Ext.header_data[1] == 90)) and\n   process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSACCESS.EXE\", \"MSPUB.EXE\", \"fltldr.exe\")] by file.path\n  [process where event.action == \"start\" and process.parent.name : \"wmiprvse.exe\" and\n   not process.Ext.token.integrity_level_name == \"system\"] by process.executable\n",
            "rule": {
                "description": "Identifies the execution of a file written or modified by Microsoft Office processes followed by a child process spawned via Windows Management Instrumentation (WMI). This behavior may indicate adversarial activity to avoid spawning a suspicious MS Office child process.",
                "id": "792411bd-59ef-4ac0-89be-786d52d1a5c8",
                "name": "Microsoft Office File Execution via WMI",
                "reference": [
                    "https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1047",
                            "name": "Windows Management Instrumentation",
                            "reference": "https://attack.mitre.org/techniques/T1047/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n [process where event.action == \"start\" and process.name : (\"EQNEDT32.EXE\", \"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSPUB.EXE\", \"MSACCESS.EXE\")]\n [registry where registry.data.strings[0] != null and\n  registry.path : (\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\User Shell Folders\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\\\\*\",\n     \"HKEY_USERS\\\\*\\\\Environment\\\\UserInitMprLogonScript\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\Load\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\Shell\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System\\\\Scripts\\\\Logoff\\\\Script\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System\\\\Scripts\\\\Logon\\\\Script\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System\\\\Scripts\\\\Shutdown\\\\Script\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System\\\\Scripts\\\\Startup\\\\Script\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Ctf\\\\LangBarAddin\\\\*\\\\FilePath\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Extensions\\\\*\\\\Exec\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Extensions\\\\*\\\\Script\",\n     \"HKEY_USERS\\\\*\\\\SOFTWARE\\\\Microsoft\\\\Command Processor\\\\Autorun\"\n     ) and\n   process.name : (\"EQNEDT32.EXE\", \"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSPUB.EXE\", \"MSACCESS.EXE\")]\n",
            "rule": {
                "description": "Identifies modification of common autostart related registry keys by a Microsoft Office process. Adversaries may use this technique to maintain persistence and avoid spawning suspicious child processes.",
                "id": "926b6cd1-c0c7-46d4-82d6-9deb6ae431d6",
                "name": "Registry Modification via Microsoft Office",
                "reference": [
                    "https://docs.microsoft.com/en-us/previous-versions/technet-magazine/ee851671(v=msdn.10)"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0001",
                        "name": "Initial Access",
                        "reference": "https://attack.mitre.org/tactics/TA0001/"
                    },
                    "technique": [
                        {
                            "id": "T1566",
                            "name": "Phishing",
                            "reference": "https://attack.mitre.org/techniques/T1566/",
                            "subtechnique": [
                                {
                                    "id": "T1566.001",
                                    "name": "Spearphishing Attachment",
                                    "reference": "https://attack.mitre.org/techniques/T1566/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1112",
                            "name": "Modify Registry",
                            "reference": "https://attack.mitre.org/techniques/T1112/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "process where event.action == \"start\" and\n  descendant of\n    [process where process.name : (\"powershell.exe\", \"pwsht.exe\", \"cmd.exe\") and\n      process.command_line :\n        (\n          \"*^*^*^*^*^*^*^*^*^*\",\n          \"*set *set *set *\",\n          \"*set *for *call *\",\n          \"*set *for *cmd *\",\n          \"*$*$*$*$*$*$*$*$*$*$*$*\",\n          \"*comspec*\",\n          \"*%%*%%*%%*\",\n          \"*''*''*''*\",\n          \"*`*`*`*`*\",\n          \"*+*+*+*+*+*\",\n          \"*[char[]](*)*-join\",\n          \"*Base64String*\",\n          \"*[*Convert]*\",\n          \"*.Text.Encoding*\",\n          \"*.Compression.*\",\n          \"*.replace(*\",\n          \"*MemoryStream*\",\n          \"*WriteAllBytes*\",\n          \"* -en* *\",\n          \"* -ec *\",\n          \"* -e *\",\n          \"* /e *\",\n          \"* /en* *\",\n          \"* /ec *\",\n          \"*WebClient*\",\n          \"*DownloadFile*\",\n          \"*DownloadString*\",\n          \"*Invoke-Exp*\",\n          \"*invoke-web*\",\n          \"*iex*\",\n          \"*iwr*\",\n          \"*Reflection.Assembly*\",\n          \"*Assembly.GetType*\"\n        )\n  ] and\n  (\n    (process.pe.original_file_name : \"wmic.exe\" and process.command_line : \"*shadowcopy*\" and \n\t process.command_line : \"*delete*\") or\n    (process.pe.original_file_name : \"vssadmin.exe\" and process.command_line : \"*shadows*\" and \n\t process.command_line : \"*delete*\") or\n    (process.pe.original_file_name : \"bcdedit.exe\" and process.command_line : (\"*bootstatuspolicy*\", \"*recoveryenabled*\")) or\n    (process.pe.original_file_name : \"wbadmin.exe\" and process.command_line : (\"*catalog*\", \"*systemstatebackup*\") and process.command_line : \"*delete*\")\n  )\n",
            "rule": {
                "description": "Identifies the execution of Windows utilities to tamper with system recovery settings. Adversaries may delete or remove built-in operating system data and turn off services designed to aid in the recovery of a corrupted system and prevent recovery.",
                "id": "99358f31-a84a-4f92-bb91-4370083acda0",
                "name": "Inhibit System Recovery via Obfuscated Commands",
                "reference": [],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1047",
                            "name": "Windows Management Instrumentation",
                            "reference": "https://attack.mitre.org/techniques/T1047/",
                            "subtechnique": null
                        },
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                },
                                {
                                    "id": "T1059.003",
                                    "name": "Windows Command Shell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/003/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0040",
                        "name": "Impact",
                        "reference": "https://attack.mitre.org/tactics/TA0040/"
                    },
                    "technique": [
                        {
                            "id": "T1490",
                            "name": "Inhibit System Recovery",
                            "reference": "https://attack.mitre.org/techniques/T1490/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "sequence by process.entity_id with maxspan=60s\n   [process where event.action == \"start\" and process.name : \"wmic.exe\" and process.args_count <= 1]\n   [library where process.name : \"wmic.exe\" and dll.name : (\"vbscript.dll\", \"jscript.dll\", \"jscript9.dll\")]\n   [any where event.action in (\"start\", \"overwrite\", \"rename\", \"modification\", \"creation\") and\n    process.name : \"wmic.exe\" and (file.name != null or network.direction == \"outgoing\")]\n",
            "rule": {
                "description": "Identifies suspicious Windows Management Instrumentation Command-Line utility (WMIC) execution with no process arguments. An adversary may attempt to bypass whitelisting controls in order to execute malicious scripts.",
                "id": "825b0e1c-a968-4447-9cf0-dafb807f2009",
                "name": "Stealthy Script Execution via WMIC",
                "reference": [],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0005",
                        "name": "Defense Evasion",
                        "reference": "https://attack.mitre.org/tactics/TA0005/"
                    },
                    "technique": [
                        {
                            "id": "T1220",
                            "name": "XSL Script Processing",
                            "reference": "https://attack.mitre.org/techniques/T1220/",
                            "subtechnique": null
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1047",
                            "name": "Windows Management Instrumentation",
                            "reference": "https://attack.mitre.org/techniques/T1047/",
                            "subtechnique": null
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 0,
            "query": "sequence by process.entity_id with maxspan=5m\n  [process where event.action == \"start\" and\n   process.pe.original_file_name : (\"cscript.exe\", \"wscript.exe\", \"powershell.exe\", \"pwsh.exe\", \"mshta.exe\")]\n  [any where _arraysearch(event.category, $arg, $arg : (\"registry\", \"file\")) and event.action != \"deletion\" and\n   (\n    (registry.data.strings[0] != null and \n     registry.path : \n            (\"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\", \n             \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\", \n             \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\*\", \n             \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\", \n             \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\", \n             \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\", \n             \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\")) or\n    (file.name != null and file.path : \"?:\\\\*\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\")\n   )\n   ]\n [any where _arraysearch(event.category, $arg, $arg : (\"registry\", \"file\")) and event.action != \"deletion\" and\n   (\n    (registry.data.strings[0] != null and \n     registry.path : \n            (\"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\", \n             \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\", \n             \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\*\", \n             \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\", \n             \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\", \n             \"*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\", \n             \"*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\")) or\n    (file.name != null and file.path : \"?:\\\\*\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\")\n   )\n   ]\n",
            "rule": {
                "description": "Identifies a Windows script interpreter writing to two persistence locations (registry run keys and startup folder). Adversaries may use this technique to maintain multiple methods of persistence on an endpoint.",
                "id": "be42f9fc-bdca-41cd-b125-f223d09eef69",
                "name": "Script Interpreter with Double Startup Persistence",
                "reference": [
                    "https://docs.microsoft.com/en-us/previous-versions/technet-magazine/ee851671(v=msdn.10)"
                ],
                "severity": "high",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                },
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "actions": [],
            "base": {},
            "format_string": null,
            "max_endpoint_version": null,
            "min_endpoint_version": "7.13.0",
            "promote": 1,
            "query": "sequence by process.entity_id\n [process where event.action : \"start\" and\n  process.pe.original_file_name : (\"wscript.exe\", \"cscript.exe\", \"powershell.exe\", \"mshta.exe\", \"pwsh.exe\")]\n [any where _arraysearch(event.category, $arg, $arg : (\"registry\", \"file\")) and event.action != \"deletion\" and\n   (\n    (file.name != null and file.path : \"?:\\\\*\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\*\") or\n    (registry.data.strings[0] != null and\n     registry.path : (\n      \"H*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n      \"H*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n      \"H*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\*\",\n      \"H*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\*\",\n      \"H*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*\",\n      \"H*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\",\n      \"H*\\\\Software\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\\\\*\") and not\n     _arraysearch(registry.data.strings, $arg, $arg :\n                   (\"*%ProgramFiles%*\",\n                    \"*:\\\\Program Files\\\\*\",\n                    \"*:\\\\Program Files (x86)\\\\*\")))\n   )\n  ]\n",
            "rule": {
                "description": "Identifies modification of startup persistence locations (registry run keys and startup folder) by a Windows script interpreter. Adversaries may use this technique to maintain persistence.",
                "id": "a85000c8-3eac-413b-8353-079343c2b6f0",
                "name": "Startup Persistence via Windows Script Interpreter",
                "reference": [
                    "https://docs.microsoft.com/en-us/previous-versions/technet-magazine/ee851671(v=msdn.10)"
                ],
                "severity": "medium",
                "version": "0.1.4"
            },
            "state_labels": [],
            "threat": [
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0003",
                        "name": "Persistence",
                        "reference": "https://attack.mitre.org/tactics/TA0003/"
                    },
                    "technique": [
                        {
                            "id": "T1547",
                            "name": "Boot or Logon Autostart Execution",
                            "reference": "https://attack.mitre.org/techniques/T1547/",
                            "subtechnique": [
                                {
                                    "id": "T1547.001",
                                    "name": "Registry Run Keys / Startup Folder",
                                    "reference": "https://attack.mitre.org/techniques/T1547/001/"
                                }
                            ]
                        }
                    ]
                },
                {
                    "framework": "MITRE ATT&CK",
                    "tactic": {
                        "id": "TA0002",
                        "name": "Execution",
                        "reference": "https://attack.mitre.org/tactics/TA0002/"
                    },
                    "technique": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "reference": "https://attack.mitre.org/techniques/T1059/",
                            "subtechnique": [
                                {
                                    "id": "T1059.001",
                                    "name": "PowerShell",
                                    "reference": "https://attack.mitre.org/techniques/T1059/001/"
                                },
                                {
                                    "id": "T1059.005",
                                    "name": "Visual Basic",
                                    "reference": "https://attack.mitre.org/techniques/T1059/005/"
                                },
                                {
                                    "id": "T1059.007",
                                    "name": "JavaScript/JScript",
                                    "reference": "https://attack.mitre.org/techniques/T1059/007/"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}